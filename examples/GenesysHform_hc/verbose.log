Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/GenesysHform_hc.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'examples/GenesysHform_hc/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 287 | train size = 229 | val size = 29 | test size = 29
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Validation rmse = 30.012075
Epoch 1
Validation rmse = 25.537702
Epoch 2
Loss = 7.5356e-03, PNorm = 34.0412, GNorm = 1.3608, lr_0 = 9.5972e-04
Validation rmse = 24.171126
Epoch 3
Validation rmse = 22.264114
Epoch 4
Loss = 4.8375e-03, PNorm = 34.0893, GNorm = 2.2193, lr_0 = 7.8137e-04
Validation rmse = 22.335660
Epoch 5
Validation rmse = 21.708234
Epoch 6
Validation rmse = 22.417140
Epoch 7
Loss = 3.0521e-03, PNorm = 34.1259, GNorm = 2.7185, lr_0 = 6.3617e-04
Validation rmse = 21.929920
Epoch 8
Validation rmse = 23.396314
Epoch 9
Loss = 2.7823e-03, PNorm = 34.1540, GNorm = 1.5257, lr_0 = 5.1795e-04
Validation rmse = 21.918403
Epoch 10
Validation rmse = 23.223626
Epoch 11
Validation rmse = 21.504665
Epoch 12
Loss = 2.1425e-03, PNorm = 34.1815, GNorm = 1.8729, lr_0 = 4.2170e-04
Validation rmse = 22.425513
Epoch 13
Validation rmse = 21.864114
Epoch 14
Loss = 2.0165e-03, PNorm = 34.2033, GNorm = 1.6854, lr_0 = 3.4333e-04
Validation rmse = 21.604636
Epoch 15
Validation rmse = 21.379854
Epoch 16
Validation rmse = 21.287641
Epoch 17
Loss = 1.4481e-03, PNorm = 34.2220, GNorm = 1.3705, lr_0 = 2.7953e-04
Validation rmse = 21.119229
Epoch 18
Validation rmse = 20.906168
Epoch 19
Loss = 1.2384e-03, PNorm = 34.2382, GNorm = 0.6901, lr_0 = 2.2758e-04
Validation rmse = 20.767520
Epoch 20
Validation rmse = 20.805692
Epoch 21
Validation rmse = 20.442610
Epoch 22
Loss = 9.3482e-04, PNorm = 34.2510, GNorm = 2.5013, lr_0 = 1.8529e-04
Validation rmse = 20.587899
Epoch 23
Validation rmse = 20.215706
Epoch 24
Loss = 7.6411e-04, PNorm = 34.2618, GNorm = 0.5729, lr_0 = 1.5086e-04
Validation rmse = 20.270416
Epoch 25
Validation rmse = 20.171636
Epoch 26
Validation rmse = 20.180245
Epoch 27
Loss = 6.8059e-04, PNorm = 34.2700, GNorm = 2.0392, lr_0 = 1.2282e-04
Validation rmse = 20.296453
Epoch 28
Validation rmse = 20.145411
Epoch 29
Loss = 7.5736e-04, PNorm = 34.2770, GNorm = 0.9374, lr_0 = 1.0000e-04
Validation rmse = 20.217316
Model 0 best validation rmse = 20.145411 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 9.111820
Ensemble test rmse = 9.111820
1-fold cross validation
Seed 0 ==> test rmse = 9.111820
Overall test rmse = 9.111820 +/- 0.000000
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/GenesysHform_hc.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'examples/GenesysHform_hc/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': True,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 287 | train size = 229 | val size = 29 | test size = 29
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Validation rmse = 31.865036
Validation Hform rmse = 31.865036
Epoch 1
Validation rmse = 30.002098
Validation Hform rmse = 30.002098
Epoch 2
Loss = 8.4234e-03, PNorm = 33.9805, GNorm = 1.2989, lr_0 = 9.5972e-04
Validation rmse = 25.831463
Validation Hform rmse = 25.831463
Epoch 3
Validation rmse = 24.312039
Validation Hform rmse = 24.312039
Epoch 4
Loss = 4.9607e-03, PNorm = 34.0281, GNorm = 0.9035, lr_0 = 7.8137e-04
Validation rmse = 23.567492
Validation Hform rmse = 23.567492
Epoch 5
Validation rmse = 23.818163
Validation Hform rmse = 23.818163
Epoch 6
Validation rmse = 23.578059
Validation Hform rmse = 23.578059
Epoch 7
Loss = 3.1545e-03, PNorm = 34.0592, GNorm = 0.8364, lr_0 = 6.3617e-04
Validation rmse = 23.289753
Validation Hform rmse = 23.289753
Epoch 8
Validation rmse = 24.084367
Validation Hform rmse = 24.084367
Epoch 9
Loss = 3.0274e-03, PNorm = 34.0834, GNorm = 1.1655, lr_0 = 5.1795e-04
Validation rmse = 23.792093
Validation Hform rmse = 23.792093
Epoch 10
Validation rmse = 24.807744
Validation Hform rmse = 24.807744
Epoch 11
Validation rmse = 24.380864
Validation Hform rmse = 24.380864
Epoch 12
Loss = 2.5758e-03, PNorm = 34.1053, GNorm = 2.7766, lr_0 = 4.2170e-04
Validation rmse = 24.966706
Validation Hform rmse = 24.966706
Epoch 13
Validation rmse = 24.585362
Validation Hform rmse = 24.585362
Epoch 14
Loss = 2.2583e-03, PNorm = 34.1232, GNorm = 0.8167, lr_0 = 3.4333e-04
Validation rmse = 24.663336
Validation Hform rmse = 24.663336
Epoch 15
Validation rmse = 24.622664
Validation Hform rmse = 24.622664
Epoch 16
Validation rmse = 24.584132
Validation Hform rmse = 24.584132
Epoch 17
Loss = 1.8601e-03, PNorm = 34.1392, GNorm = 0.5765, lr_0 = 2.7953e-04
Validation rmse = 24.511269
Validation Hform rmse = 24.511269
Epoch 18
Validation rmse = 24.285807
Validation Hform rmse = 24.285807
Epoch 19
Loss = 1.6656e-03, PNorm = 34.1527, GNorm = 0.9939, lr_0 = 2.2758e-04
Validation rmse = 24.216610
Validation Hform rmse = 24.216610
Epoch 20
Validation rmse = 24.034056
Validation Hform rmse = 24.034056
Epoch 21
Validation rmse = 23.881436
Validation Hform rmse = 23.881436
Epoch 22
Loss = 1.1993e-03, PNorm = 34.1640, GNorm = 1.2859, lr_0 = 1.8529e-04
Validation rmse = 23.773988
Validation Hform rmse = 23.773988
Epoch 23
Validation rmse = 23.842256
Validation Hform rmse = 23.842256
Epoch 24
Loss = 1.1092e-03, PNorm = 34.1736, GNorm = 0.6259, lr_0 = 1.5086e-04
Validation rmse = 23.681895
Validation Hform rmse = 23.681895
Epoch 25
Validation rmse = 23.823489
Validation Hform rmse = 23.823489
Epoch 26
Validation rmse = 23.598949
Validation Hform rmse = 23.598949
Epoch 27
Loss = 1.0488e-03, PNorm = 34.1814, GNorm = 0.8985, lr_0 = 1.2282e-04
Validation rmse = 23.586863
Validation Hform rmse = 23.586863
Epoch 28
Validation rmse = 23.623747
Validation Hform rmse = 23.623747
Epoch 29
Loss = 1.1429e-03, PNorm = 34.1883, GNorm = 0.3871, lr_0 = 1.0000e-04
Validation rmse = 23.524010
Validation Hform rmse = 23.524010
Model 0 best validation rmse = 23.289753 on epoch 7
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 18.984976
Model 0 test Hform rmse = 18.984976
Ensemble test rmse = 18.984976
Ensemble test Hform rmse = 18.984976
1-fold cross validation
Seed 0 ==> test rmse = 18.984976
Seed 0 ==> test Hform rmse = 18.984976
Overall test rmse = 18.984976 +/- 0.000000
Overall test Hform rmse = 18.984976 +/- 0.000000
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/GenesysHform_hc.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'examples/GenesysHform_hc/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': True,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 287 | train size = 229 | val size = 29 | test size = 29
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Validation rmse = 32.341128
Validation Hform rmse = 32.341128
Epoch 1
Validation rmse = 31.730526
Validation Hform rmse = 31.730526
Epoch 2
Loss = 8.8121e-03, PNorm = 34.0477, GNorm = 1.1844, lr_0 = 9.5972e-04
Validation rmse = 23.862988
Validation Hform rmse = 23.862988
Epoch 3
Validation rmse = 26.239064
Validation Hform rmse = 26.239064
Epoch 4
Loss = 4.7482e-03, PNorm = 34.0994, GNorm = 2.4631, lr_0 = 7.8137e-04
Validation rmse = 24.306196
Validation Hform rmse = 24.306196
Epoch 5
Validation rmse = 23.127757
Validation Hform rmse = 23.127757
Epoch 6
Validation rmse = 24.228979
Validation Hform rmse = 24.228979
Epoch 7
Loss = 3.1829e-03, PNorm = 34.1322, GNorm = 1.5771, lr_0 = 6.3617e-04
Validation rmse = 22.905687
Validation Hform rmse = 22.905687
Epoch 8
Validation rmse = 23.976998
Validation Hform rmse = 23.976998
Epoch 9
Loss = 3.1079e-03, PNorm = 34.1572, GNorm = 0.7698, lr_0 = 5.1795e-04
Validation rmse = 22.790044
Validation Hform rmse = 22.790044
Epoch 10
Validation rmse = 23.622158
Validation Hform rmse = 23.622158
Epoch 11
Validation rmse = 22.929472
Validation Hform rmse = 22.929472
Epoch 12
Loss = 2.7163e-03, PNorm = 34.1826, GNorm = 2.3181, lr_0 = 4.2170e-04
Validation rmse = 23.267384
Validation Hform rmse = 23.267384
Epoch 13
Validation rmse = 23.003204
Validation Hform rmse = 23.003204
Epoch 14
Loss = 2.2044e-03, PNorm = 34.2049, GNorm = 1.1290, lr_0 = 3.4333e-04
Validation rmse = 22.874271
Validation Hform rmse = 22.874271
Epoch 15
Validation rmse = 22.938729
Validation Hform rmse = 22.938729
Epoch 16
Validation rmse = 22.642419
Validation Hform rmse = 22.642419
Epoch 17
Loss = 1.8845e-03, PNorm = 34.2251, GNorm = 0.9183, lr_0 = 2.7953e-04
Validation rmse = 22.754864
Validation Hform rmse = 22.754864
Epoch 18
Validation rmse = 22.359754
Validation Hform rmse = 22.359754
Epoch 19
Loss = 1.5608e-03, PNorm = 34.2424, GNorm = 0.9747, lr_0 = 2.2758e-04
Validation rmse = 22.348171
Validation Hform rmse = 22.348171
Epoch 20
Validation rmse = 22.118753
Validation Hform rmse = 22.118753
Epoch 21
Validation rmse = 21.888961
Validation Hform rmse = 21.888961
Epoch 22
Loss = 1.1468e-03, PNorm = 34.2563, GNorm = 1.3662, lr_0 = 1.8529e-04
Validation rmse = 21.758289
Validation Hform rmse = 21.758289
Epoch 23
Validation rmse = 21.866306
Validation Hform rmse = 21.866306
Epoch 24
Loss = 9.3373e-04, PNorm = 34.2679, GNorm = 0.4570, lr_0 = 1.5086e-04
Validation rmse = 21.576455
Validation Hform rmse = 21.576455
Epoch 25
Validation rmse = 21.734213
Validation Hform rmse = 21.734213
Epoch 26
Validation rmse = 21.529828
Validation Hform rmse = 21.529828
Epoch 27
Loss = 8.6545e-04, PNorm = 34.2771, GNorm = 0.8658, lr_0 = 1.2282e-04
Validation rmse = 21.531315
Validation Hform rmse = 21.531315
Epoch 28
Validation rmse = 21.545429
Validation Hform rmse = 21.545429
Epoch 29
Loss = 1.0180e-03, PNorm = 34.2852, GNorm = 0.6261, lr_0 = 1.0000e-04
Validation rmse = 21.453076
Validation Hform rmse = 21.453076
Model 0 best validation rmse = 21.453076 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 10.918457
Model 0 test Hform rmse = 10.918457
Ensemble test rmse = 10.918457
Ensemble test Hform rmse = 10.918457
1-fold cross validation
Seed 0 ==> test rmse = 10.918457
Seed 0 ==> test Hform rmse = 10.918457
Overall test rmse = 10.918457 +/- 0.000000
Overall test Hform rmse = 10.918457 +/- 0.000000
