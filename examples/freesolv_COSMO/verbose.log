Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/freesolv_COSMO_woDup.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 1000,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 1000,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'examples/freesolv_COSMO/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Warning: 1 SMILES are invalid.
Number of tasks = 1
Splitting data with seed 0
Total size = 719 | train size = 575 | val size = 72 | test size = 72
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=161, out_features=1000, bias=False)
      (W_h): Linear(in_features=1000, out_features=1000, bias=False)
      (W_o): Linear(in_features=1147, out_features=1000, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1000, out_features=1000, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1000, out_features=1, bias=True)
  )
)
Number of parameters = 3,311,001
Epoch 0
Loss = 2.2720e-02, PNorm = 57.8565, GNorm = 4.3843, lr_0 = 5.0909e-04
Validation rmse = 5.334033
Epoch 1
Loss = 2.0565e-02, PNorm = 57.9281, GNorm = 1.3647, lr_0 = 9.1818e-04
Validation rmse = 5.638092
Epoch 2
Loss = 1.8829e-02, PNorm = 58.0582, GNorm = 0.5012, lr_0 = 9.8306e-04
Validation rmse = 4.810450
Epoch 3
Loss = 1.4064e-02, PNorm = 58.2060, GNorm = 3.0161, lr_0 = 9.6228e-04
Validation rmse = 3.575801
Epoch 4
Loss = 9.2163e-03, PNorm = 58.3601, GNorm = 5.5275, lr_0 = 9.4195e-04
Validation rmse = 3.391912
Epoch 5
Loss = 7.3806e-03, PNorm = 58.4869, GNorm = 5.6738, lr_0 = 9.2204e-04
Validation rmse = 3.774222
Epoch 6
Loss = 3.0155e-03, PNorm = 58.6044, GNorm = 1.5448, lr_0 = 9.0255e-04
Validation rmse = 4.378006
Epoch 7
Loss = 5.4508e-03, PNorm = 58.6975, GNorm = 4.0488, lr_0 = 8.8348e-04
Validation rmse = 3.082194
Epoch 8
Loss = 1.1927e-03, PNorm = 58.7995, GNorm = 0.6027, lr_0 = 8.6481e-04
Validation rmse = 3.793293
Epoch 9
Loss = 1.8465e-03, PNorm = 58.8811, GNorm = 1.3987, lr_0 = 8.4653e-04
Loss = 3.0265e-03, PNorm = 58.9376, GNorm = 1.2967, lr_0 = 8.2864e-04
Validation rmse = 2.444641
Epoch 10
Loss = 2.7658e-03, PNorm = 58.9979, GNorm = 0.9287, lr_0 = 8.1113e-04
Validation rmse = 3.120322
Epoch 11
Loss = 2.3294e-03, PNorm = 59.0424, GNorm = 0.2933, lr_0 = 7.9399e-04
Validation rmse = 1.665257
Epoch 12
Loss = 1.6088e-03, PNorm = 59.0768, GNorm = 0.9339, lr_0 = 7.7721e-04
Validation rmse = 1.998163
Epoch 13
Loss = 1.2990e-03, PNorm = 59.1169, GNorm = 2.1095, lr_0 = 7.6078e-04
Validation rmse = 1.969529
Epoch 14
Loss = 6.7997e-04, PNorm = 59.1342, GNorm = 0.3692, lr_0 = 7.4471e-04
Validation rmse = 2.553314
Epoch 15
Loss = 6.3284e-04, PNorm = 59.1593, GNorm = 0.5088, lr_0 = 7.2897e-04
Validation rmse = 1.624012
Epoch 16
Loss = 8.5914e-04, PNorm = 59.1832, GNorm = 0.6358, lr_0 = 7.1356e-04
Validation rmse = 2.007023
Epoch 17
Loss = 4.9792e-04, PNorm = 59.2065, GNorm = 0.8217, lr_0 = 6.9848e-04
Validation rmse = 1.756641
Epoch 18
Loss = 3.6949e-04, PNorm = 59.2250, GNorm = 0.2259, lr_0 = 6.8372e-04
Validation rmse = 1.544158
Epoch 19
Loss = 3.5740e-04, PNorm = 59.2305, GNorm = 0.1976, lr_0 = 6.6927e-04
Loss = 3.9103e-04, PNorm = 59.2518, GNorm = 0.3061, lr_0 = 6.5513e-04
Validation rmse = 2.491851
Epoch 20
Loss = 1.3862e-03, PNorm = 59.2737, GNorm = 0.3054, lr_0 = 6.4128e-04
Validation rmse = 1.521041
Epoch 21
Loss = 1.3256e-03, PNorm = 59.2869, GNorm = 0.5115, lr_0 = 6.2773e-04
Validation rmse = 1.716688
Epoch 22
Loss = 5.8805e-04, PNorm = 59.2944, GNorm = 0.2630, lr_0 = 6.1447e-04
Validation rmse = 1.655649
Epoch 23
Loss = 4.2552e-04, PNorm = 59.3104, GNorm = 0.4366, lr_0 = 6.0148e-04
Validation rmse = 1.980328
Epoch 24
Loss = 3.1325e-04, PNorm = 59.3320, GNorm = 0.2548, lr_0 = 5.8877e-04
Validation rmse = 1.514094
Epoch 25
Loss = 4.7409e-04, PNorm = 59.3359, GNorm = 0.8290, lr_0 = 5.7633e-04
Validation rmse = 2.170290
Epoch 26
Loss = 3.9473e-04, PNorm = 59.3561, GNorm = 0.3505, lr_0 = 5.6415e-04
Validation rmse = 1.553907
Epoch 27
Loss = 3.0095e-04, PNorm = 59.3759, GNorm = 0.3399, lr_0 = 5.5222e-04
Validation rmse = 1.323921
Epoch 28
Loss = 1.7824e-04, PNorm = 59.3795, GNorm = 0.1501, lr_0 = 5.4055e-04
Validation rmse = 1.515340
Epoch 29
Loss = 9.3278e-04, PNorm = 59.3893, GNorm = 1.9209, lr_0 = 5.2913e-04
Loss = 3.1055e-04, PNorm = 59.3983, GNorm = 0.3821, lr_0 = 5.1795e-04
Validation rmse = 1.748567
Epoch 30
Loss = 2.9349e-04, PNorm = 59.4177, GNorm = 0.1524, lr_0 = 5.0700e-04
Validation rmse = 1.529663
Epoch 31
Loss = 3.1725e-04, PNorm = 59.4206, GNorm = 0.8523, lr_0 = 4.9629e-04
Validation rmse = 1.395928
Epoch 32
Loss = 2.8924e-04, PNorm = 59.4244, GNorm = 0.3728, lr_0 = 4.8580e-04
Validation rmse = 1.910806
Epoch 33
Loss = 2.1767e-04, PNorm = 59.4265, GNorm = 0.4121, lr_0 = 4.7553e-04
Validation rmse = 1.322428
Epoch 34
Loss = 1.5756e-04, PNorm = 59.4409, GNorm = 0.1605, lr_0 = 4.6548e-04
Validation rmse = 1.511779
Epoch 35
Loss = 2.7167e-04, PNorm = 59.4452, GNorm = 0.7509, lr_0 = 4.5565e-04
Validation rmse = 1.649718
Epoch 36
Loss = 2.0545e-04, PNorm = 59.4628, GNorm = 0.1789, lr_0 = 4.4602e-04
Validation rmse = 1.392572
Epoch 37
Loss = 1.9184e-04, PNorm = 59.4566, GNorm = 0.1307, lr_0 = 4.3659e-04
Validation rmse = 2.138131
Epoch 38
Loss = 4.9538e-04, PNorm = 59.4725, GNorm = 1.2898, lr_0 = 4.2736e-04
Validation rmse = 1.298651
Epoch 39
Loss = 4.5580e-04, PNorm = 59.4712, GNorm = 0.4295, lr_0 = 4.1833e-04
Loss = 2.1856e-04, PNorm = 59.4825, GNorm = 0.2007, lr_0 = 4.0949e-04
Validation rmse = 1.864132
Epoch 40
Loss = 2.0403e-04, PNorm = 59.4887, GNorm = 0.2159, lr_0 = 4.0084e-04
Validation rmse = 1.386603
Epoch 41
Loss = 1.7823e-04, PNorm = 59.4974, GNorm = 0.2658, lr_0 = 3.9237e-04
Validation rmse = 1.436432
Epoch 42
Loss = 2.1825e-04, PNorm = 59.4991, GNorm = 0.3794, lr_0 = 3.8407e-04
Validation rmse = 1.262378
Epoch 43
Loss = 2.8291e-04, PNorm = 59.5124, GNorm = 0.3849, lr_0 = 3.7596e-04
Validation rmse = 1.800541
Epoch 44
Loss = 2.1442e-04, PNorm = 59.5170, GNorm = 0.7644, lr_0 = 3.6801e-04
Validation rmse = 1.262705
Epoch 45
Loss = 2.5942e-04, PNorm = 59.5213, GNorm = 0.7544, lr_0 = 3.6024e-04
Validation rmse = 1.410753
Epoch 46
Loss = 2.3064e-04, PNorm = 59.5267, GNorm = 0.5678, lr_0 = 3.5262e-04
Validation rmse = 1.366544
Epoch 47
Loss = 2.9067e-04, PNorm = 59.5292, GNorm = 0.4780, lr_0 = 3.4517e-04
Validation rmse = 1.407256
Epoch 48
Loss = 8.9680e-05, PNorm = 59.5356, GNorm = 0.0891, lr_0 = 3.3788e-04
Validation rmse = 1.360440
Epoch 49
Loss = 3.8651e-04, PNorm = 59.5415, GNorm = 0.3938, lr_0 = 3.3074e-04
Loss = 1.0499e-04, PNorm = 59.5471, GNorm = 0.1372, lr_0 = 3.2375e-04
Validation rmse = 1.415874
Epoch 50
Loss = 2.4426e-04, PNorm = 59.5449, GNorm = 0.4345, lr_0 = 3.1690e-04
Validation rmse = 1.304469
Epoch 51
Loss = 2.2352e-04, PNorm = 59.5541, GNorm = 0.2786, lr_0 = 3.1021e-04
Validation rmse = 1.458895
Epoch 52
Loss = 1.4408e-04, PNorm = 59.5564, GNorm = 0.2521, lr_0 = 3.0365e-04
Validation rmse = 1.212431
Epoch 53
Loss = 1.3618e-04, PNorm = 59.5572, GNorm = 0.4155, lr_0 = 2.9723e-04
Validation rmse = 1.295426
Epoch 54
Loss = 1.5523e-04, PNorm = 59.5604, GNorm = 0.0727, lr_0 = 2.9095e-04
Validation rmse = 1.285097
Epoch 55
Loss = 1.1857e-04, PNorm = 59.5663, GNorm = 0.3049, lr_0 = 2.8480e-04
Validation rmse = 1.469783
Epoch 56
Loss = 6.9675e-05, PNorm = 59.5737, GNorm = 0.1323, lr_0 = 2.7878e-04
Validation rmse = 1.375435
Epoch 57
Loss = 1.7998e-04, PNorm = 59.5677, GNorm = 0.0626, lr_0 = 2.7289e-04
Validation rmse = 1.461662
Epoch 58
Loss = 6.2656e-05, PNorm = 59.5703, GNorm = 0.0980, lr_0 = 2.6713e-04
Validation rmse = 1.545503
Epoch 59
Loss = 9.0755e-05, PNorm = 59.5730, GNorm = 0.2969, lr_0 = 2.6148e-04
Loss = 1.6471e-04, PNorm = 59.5794, GNorm = 0.2378, lr_0 = 2.5595e-04
Validation rmse = 1.540798
Epoch 60
Loss = 1.5668e-04, PNorm = 59.5841, GNorm = 0.1855, lr_0 = 2.5055e-04
Validation rmse = 1.371279
Epoch 61
Loss = 1.2228e-04, PNorm = 59.5876, GNorm = 0.4164, lr_0 = 2.4525e-04
Validation rmse = 1.320874
Epoch 62
Loss = 1.1210e-04, PNorm = 59.5915, GNorm = 0.1456, lr_0 = 2.4007e-04
Validation rmse = 1.226106
Epoch 63
Loss = 1.0493e-04, PNorm = 59.5900, GNorm = 0.0818, lr_0 = 2.3499e-04
Validation rmse = 1.322847
Epoch 64
Loss = 1.4188e-04, PNorm = 59.5917, GNorm = 0.7076, lr_0 = 2.3003e-04
Validation rmse = 1.173439
Epoch 65
Loss = 2.4679e-04, PNorm = 59.5991, GNorm = 0.1460, lr_0 = 2.2517e-04
Validation rmse = 1.338279
Epoch 66
Loss = 1.0652e-04, PNorm = 59.6041, GNorm = 0.1236, lr_0 = 2.2041e-04
Validation rmse = 1.257500
Epoch 67
Loss = 9.8253e-05, PNorm = 59.6033, GNorm = 0.0972, lr_0 = 2.1575e-04
Validation rmse = 1.229973
Epoch 68
Loss = 9.5896e-05, PNorm = 59.6055, GNorm = 0.2639, lr_0 = 2.1119e-04
Validation rmse = 1.412220
Epoch 69
Loss = 6.4460e-05, PNorm = 59.6092, GNorm = 0.1739, lr_0 = 2.0673e-04
Loss = 1.4485e-04, PNorm = 59.6089, GNorm = 0.0782, lr_0 = 2.0236e-04
Validation rmse = 1.226285
Epoch 70
Loss = 1.6291e-04, PNorm = 59.6124, GNorm = 0.1046, lr_0 = 1.9808e-04
Validation rmse = 1.405014
Epoch 71
Loss = 1.0888e-04, PNorm = 59.6167, GNorm = 0.0919, lr_0 = 1.9390e-04
Validation rmse = 1.329343
Epoch 72
Loss = 8.8540e-05, PNorm = 59.6174, GNorm = 0.0949, lr_0 = 1.8980e-04
Validation rmse = 1.160512
Epoch 73
Loss = 1.6758e-04, PNorm = 59.6170, GNorm = 0.3908, lr_0 = 1.8579e-04
Validation rmse = 1.219837
Epoch 74
Loss = 1.1516e-04, PNorm = 59.6198, GNorm = 0.4029, lr_0 = 1.8186e-04
Validation rmse = 1.265942
Epoch 75
Loss = 1.2305e-04, PNorm = 59.6236, GNorm = 0.2734, lr_0 = 1.7802e-04
Validation rmse = 1.239141
Epoch 76
Loss = 1.2348e-04, PNorm = 59.6254, GNorm = 0.0948, lr_0 = 1.7426e-04
Validation rmse = 1.389665
Epoch 77
Loss = 6.5179e-05, PNorm = 59.6275, GNorm = 0.1794, lr_0 = 1.7057e-04
Validation rmse = 1.259543
Epoch 78
Loss = 1.2732e-04, PNorm = 59.6273, GNorm = 0.1837, lr_0 = 1.6697e-04
Validation rmse = 1.173602
Epoch 79
Loss = 5.3867e-05, PNorm = 59.6254, GNorm = 0.0768, lr_0 = 1.6344e-04
Loss = 1.7644e-04, PNorm = 59.6284, GNorm = 0.2913, lr_0 = 1.5999e-04
Validation rmse = 1.389270
Epoch 80
Loss = 9.5738e-05, PNorm = 59.6289, GNorm = 0.5574, lr_0 = 1.5660e-04
Validation rmse = 1.152745
Epoch 81
Loss = 1.2090e-04, PNorm = 59.6290, GNorm = 0.2808, lr_0 = 1.5330e-04
Validation rmse = 1.201414
Epoch 82
Loss = 9.9863e-05, PNorm = 59.6305, GNorm = 0.3202, lr_0 = 1.5006e-04
Validation rmse = 1.257046
Epoch 83
Loss = 1.3808e-04, PNorm = 59.6313, GNorm = 0.4072, lr_0 = 1.4688e-04
Validation rmse = 1.253657
Epoch 84
Loss = 1.1155e-04, PNorm = 59.6366, GNorm = 0.1018, lr_0 = 1.4378e-04
Validation rmse = 1.353392
Epoch 85
Loss = 8.9056e-05, PNorm = 59.6372, GNorm = 0.1769, lr_0 = 1.4074e-04
Validation rmse = 1.238343
Epoch 86
Loss = 7.6079e-05, PNorm = 59.6372, GNorm = 0.0723, lr_0 = 1.3777e-04
Validation rmse = 1.251502
Epoch 87
Loss = 1.3299e-04, PNorm = 59.6400, GNorm = 0.1942, lr_0 = 1.3486e-04
Validation rmse = 1.295629
Epoch 88
Loss = 1.0496e-04, PNorm = 59.6423, GNorm = 0.1915, lr_0 = 1.3201e-04
Validation rmse = 1.126514
Epoch 89
Loss = 5.3378e-05, PNorm = 59.6446, GNorm = 0.1192, lr_0 = 1.2922e-04
Loss = 1.1287e-04, PNorm = 59.6453, GNorm = 0.0715, lr_0 = 1.2649e-04
Validation rmse = 1.165571
Epoch 90
Loss = 8.1086e-05, PNorm = 59.6437, GNorm = 0.2869, lr_0 = 1.2381e-04
Validation rmse = 1.329537
Epoch 91
Loss = 9.1642e-05, PNorm = 59.6422, GNorm = 0.1680, lr_0 = 1.2120e-04
Validation rmse = 1.154895
Epoch 92
Loss = 1.0696e-04, PNorm = 59.6428, GNorm = 0.2438, lr_0 = 1.1863e-04
Validation rmse = 1.190248
Epoch 93
Loss = 7.8152e-05, PNorm = 59.6448, GNorm = 0.2572, lr_0 = 1.1613e-04
Validation rmse = 1.210323
Epoch 94
Loss = 1.4150e-04, PNorm = 59.6477, GNorm = 0.2886, lr_0 = 1.1367e-04
Validation rmse = 1.303805
Epoch 95
Loss = 7.6712e-05, PNorm = 59.6478, GNorm = 0.1747, lr_0 = 1.1127e-04
Validation rmse = 1.372794
Epoch 96
Loss = 6.0936e-05, PNorm = 59.6511, GNorm = 0.1931, lr_0 = 1.0892e-04
Validation rmse = 1.289517
Epoch 97
Loss = 7.8993e-05, PNorm = 59.6526, GNorm = 0.2292, lr_0 = 1.0662e-04
Validation rmse = 1.150320
Epoch 98
Loss = 5.1330e-05, PNorm = 59.6528, GNorm = 0.1607, lr_0 = 1.0436e-04
Validation rmse = 1.235124
Epoch 99
Loss = 1.4092e-04, PNorm = 59.6542, GNorm = 0.4546, lr_0 = 1.0216e-04
Loss = 8.1624e-05, PNorm = 59.6553, GNorm = 0.1730, lr_0 = 1.0000e-04
Validation rmse = 1.344794
Model 0 best validation rmse = 1.126514 on epoch 88
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 13.200330
Ensemble test rmse = 13.200330
1-fold cross validation
Seed 0 ==> test rmse = 13.200330
Overall test rmse = 13.200330 +/- 0.000000
