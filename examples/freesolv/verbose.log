Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/freesolv.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'examples/freesolv/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 642 | train size = 513 | val size = 64 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.8087e-02, PNorm = 34.0606, GNorm = 3.0611, lr_0 = 5.5000e-04
Validation rmse = 3.065977
Epoch 1
Loss = 1.2808e-02, PNorm = 34.1025, GNorm = 6.5265, lr_0 = 1.0000e-03
Validation rmse = 2.900525
Epoch 2
Loss = 9.4816e-03, PNorm = 34.1585, GNorm = 4.0366, lr_0 = 9.2106e-04
Validation rmse = 2.117267
Epoch 3
Loss = 8.5096e-03, PNorm = 34.2140, GNorm = 13.3103, lr_0 = 8.4834e-04
Validation rmse = 2.289364
Epoch 4
Loss = 6.2381e-03, PNorm = 34.2602, GNorm = 0.9994, lr_0 = 7.8137e-04
Validation rmse = 2.039969
Epoch 5
Loss = 5.0267e-03, PNorm = 34.3055, GNorm = 4.9609, lr_0 = 7.1969e-04
Validation rmse = 1.999043
Epoch 6
Loss = 3.4656e-03, PNorm = 34.3397, GNorm = 2.0124, lr_0 = 6.6287e-04
Validation rmse = 1.569985
Epoch 7
Loss = 2.3802e-03, PNorm = 34.3719, GNorm = 0.5901, lr_0 = 6.1054e-04
Validation rmse = 1.464273
Epoch 8
Loss = 2.3802e-03, PNorm = 34.3912, GNorm = 1.0686, lr_0 = 5.6234e-04
Validation rmse = 1.380734
Epoch 9
Loss = 2.0451e-03, PNorm = 34.4101, GNorm = 1.9277, lr_0 = 5.1795e-04
Validation rmse = 1.230276
Epoch 10
Loss = 1.6947e-03, PNorm = 34.4252, GNorm = 0.9387, lr_0 = 4.7706e-04
Validation rmse = 1.190970
Epoch 11
Loss = 1.4700e-03, PNorm = 34.4367, GNorm = 1.4059, lr_0 = 4.3940e-04
Validation rmse = 1.204739
Epoch 12
Loss = 1.5177e-03, PNorm = 34.4506, GNorm = 2.3066, lr_0 = 4.0471e-04
Validation rmse = 1.138348
Epoch 13
Loss = 1.3442e-03, PNorm = 34.4609, GNorm = 0.6160, lr_0 = 3.7276e-04
Validation rmse = 1.135596
Epoch 14
Loss = 1.2245e-03, PNorm = 34.4716, GNorm = 2.6507, lr_0 = 3.4333e-04
Validation rmse = 1.210138
Epoch 15
Loss = 1.3241e-03, PNorm = 34.4830, GNorm = 1.5656, lr_0 = 3.1623e-04
Validation rmse = 1.104442
Epoch 16
Loss = 1.1401e-03, PNorm = 34.4905, GNorm = 1.9923, lr_0 = 2.9126e-04
Validation rmse = 1.085869
Epoch 17
Loss = 1.0747e-03, PNorm = 34.4998, GNorm = 1.5097, lr_0 = 2.6827e-04
Validation rmse = 1.088512
Epoch 18
Loss = 1.0870e-03, PNorm = 34.5086, GNorm = 0.5661, lr_0 = 2.4709e-04
Validation rmse = 1.089857
Epoch 19
Loss = 1.0262e-03, PNorm = 34.5154, GNorm = 0.7437, lr_0 = 2.2758e-04
Validation rmse = 1.072925
Epoch 20
Loss = 9.6037e-04, PNorm = 34.5225, GNorm = 1.5712, lr_0 = 2.0962e-04
Validation rmse = 1.068876
Epoch 21
Loss = 9.6637e-04, PNorm = 34.5295, GNorm = 0.5505, lr_0 = 1.9307e-04
Validation rmse = 1.089558
Epoch 22
Loss = 9.2606e-04, PNorm = 34.5356, GNorm = 1.7847, lr_0 = 1.7783e-04
Validation rmse = 1.046538
Epoch 23
Loss = 8.4798e-04, PNorm = 34.5415, GNorm = 0.8085, lr_0 = 1.6379e-04
Validation rmse = 1.046150
Epoch 24
Loss = 8.9004e-04, PNorm = 34.5465, GNorm = 1.0078, lr_0 = 1.5086e-04
Validation rmse = 1.053842
Epoch 25
Loss = 8.6281e-04, PNorm = 34.5513, GNorm = 0.9483, lr_0 = 1.3895e-04
Validation rmse = 1.044356
Epoch 26
Loss = 7.8705e-04, PNorm = 34.5562, GNorm = 0.7252, lr_0 = 1.2798e-04
Validation rmse = 1.045423
Epoch 27
Loss = 8.4052e-04, PNorm = 34.5609, GNorm = 0.6177, lr_0 = 1.1788e-04
Validation rmse = 1.031297
Epoch 28
Loss = 8.1426e-04, PNorm = 34.5644, GNorm = 0.7370, lr_0 = 1.0857e-04
Validation rmse = 1.047387
Epoch 29
Loss = 8.2302e-04, PNorm = 34.5681, GNorm = 1.5624, lr_0 = 1.0000e-04
Validation rmse = 1.028776
Model 0 best validation rmse = 1.028776 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.969351
Ensemble test rmse = 0.969351
1-fold cross validation
Seed 0 ==> test rmse = 0.969351
Overall test rmse = 0.969351 +/- 0.000000
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/freesolv.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'examples/freesolv/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 642 | train size = 513 | val size = 64 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.6811e-02, PNorm = 33.9947, GNorm = 2.6946, lr_0 = 5.5000e-04
Validation rmse = 2.780995
Epoch 1
Loss = 1.1404e-02, PNorm = 34.0328, GNorm = 1.3415, lr_0 = 1.0000e-03
Validation rmse = 2.518217
Epoch 2
Loss = 8.9078e-03, PNorm = 34.0770, GNorm = 2.8310, lr_0 = 9.2106e-04
Validation rmse = 2.182717
Epoch 3
Loss = 7.3432e-03, PNorm = 34.1253, GNorm = 18.8793, lr_0 = 8.4834e-04
Validation rmse = 1.880814
Epoch 4
Loss = 6.1374e-03, PNorm = 34.1661, GNorm = 7.3580, lr_0 = 7.8137e-04
Validation rmse = 2.673581
Epoch 5
Loss = 6.5136e-03, PNorm = 34.2066, GNorm = 8.1722, lr_0 = 7.1969e-04
Validation rmse = 2.347251
Epoch 6
Loss = 4.3468e-03, PNorm = 34.2435, GNorm = 2.0175, lr_0 = 6.6287e-04
Validation rmse = 1.713048
Epoch 7
Loss = 2.9342e-03, PNorm = 34.2789, GNorm = 1.0500, lr_0 = 6.1054e-04
Validation rmse = 1.556951
Epoch 8
Loss = 2.7858e-03, PNorm = 34.3041, GNorm = 2.7309, lr_0 = 5.6234e-04
Validation rmse = 1.429618
Epoch 9
Loss = 2.1627e-03, PNorm = 34.3271, GNorm = 1.9859, lr_0 = 5.1795e-04
Validation rmse = 1.374965
Epoch 10
Loss = 2.0486e-03, PNorm = 34.3438, GNorm = 3.0109, lr_0 = 4.7706e-04
Validation rmse = 1.349163
Epoch 11
Loss = 1.7061e-03, PNorm = 34.3568, GNorm = 2.7029, lr_0 = 4.3940e-04
Validation rmse = 1.418130
Epoch 12
Loss = 1.7898e-03, PNorm = 34.3709, GNorm = 3.7536, lr_0 = 4.0471e-04
Validation rmse = 1.299747
Epoch 13
Loss = 1.5369e-03, PNorm = 34.3806, GNorm = 1.7079, lr_0 = 3.7276e-04
Validation rmse = 1.239855
Epoch 14
Loss = 1.3156e-03, PNorm = 34.3904, GNorm = 0.8452, lr_0 = 3.4333e-04
Validation rmse = 1.212821
Epoch 15
Loss = 1.3453e-03, PNorm = 34.4012, GNorm = 0.7510, lr_0 = 3.1623e-04
Validation rmse = 1.189502
Epoch 16
Loss = 1.2844e-03, PNorm = 34.4087, GNorm = 1.7834, lr_0 = 2.9126e-04
Validation rmse = 1.171232
Epoch 17
Loss = 1.2086e-03, PNorm = 34.4175, GNorm = 1.0660, lr_0 = 2.6827e-04
Validation rmse = 1.168817
Epoch 18
Loss = 1.1656e-03, PNorm = 34.4258, GNorm = 0.7747, lr_0 = 2.4709e-04
Validation rmse = 1.157410
Epoch 19
Loss = 1.1155e-03, PNorm = 34.4322, GNorm = 0.6088, lr_0 = 2.2758e-04
Validation rmse = 1.154067
Epoch 20
Loss = 1.0549e-03, PNorm = 34.4393, GNorm = 2.5561, lr_0 = 2.0962e-04
Validation rmse = 1.142179
Epoch 21
Loss = 1.0483e-03, PNorm = 34.4462, GNorm = 0.8509, lr_0 = 1.9307e-04
Validation rmse = 1.151879
Epoch 22
Loss = 1.0096e-03, PNorm = 34.4521, GNorm = 2.0793, lr_0 = 1.7783e-04
Validation rmse = 1.131494
Epoch 23
Loss = 9.2601e-04, PNorm = 34.4579, GNorm = 0.8259, lr_0 = 1.6379e-04
Validation rmse = 1.129252
Epoch 24
Loss = 9.5819e-04, PNorm = 34.4633, GNorm = 1.0207, lr_0 = 1.5086e-04
Validation rmse = 1.137263
Epoch 25
Loss = 9.2102e-04, PNorm = 34.4678, GNorm = 0.7870, lr_0 = 1.3895e-04
Validation rmse = 1.124156
Epoch 26
Loss = 8.4970e-04, PNorm = 34.4728, GNorm = 0.5920, lr_0 = 1.2798e-04
Validation rmse = 1.125588
Epoch 27
Loss = 9.0705e-04, PNorm = 34.4771, GNorm = 0.7467, lr_0 = 1.1788e-04
Validation rmse = 1.111765
Epoch 28
Loss = 8.8889e-04, PNorm = 34.4809, GNorm = 0.5492, lr_0 = 1.0857e-04
Validation rmse = 1.117194
Epoch 29
Loss = 8.7991e-04, PNorm = 34.4846, GNorm = 1.3972, lr_0 = 1.0000e-04
Validation rmse = 1.123963
Model 0 best validation rmse = 1.111765 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.982025
Ensemble test rmse = 0.982025
1-fold cross validation
Seed 0 ==> test rmse = 0.982025
Overall test rmse = 0.982025 +/- 0.000000
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/freesolv.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'examples/freesolv/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 642 | train size = 513 | val size = 64 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.7918e-02, PNorm = 33.9547, GNorm = 2.8252, lr_0 = 5.5000e-04
Validation rmse = 2.905783
Epoch 1
Loss = 1.1920e-02, PNorm = 33.9968, GNorm = 9.4505, lr_0 = 1.0000e-03
Validation rmse = 2.678018
Epoch 2
Loss = 8.0965e-03, PNorm = 34.0496, GNorm = 3.0202, lr_0 = 9.2106e-04
Validation rmse = 2.040608
Epoch 3
Loss = 7.3158e-03, PNorm = 34.0969, GNorm = 11.8390, lr_0 = 8.4834e-04
Validation rmse = 2.244063
Epoch 4
Loss = 6.0531e-03, PNorm = 34.1354, GNorm = 7.8100, lr_0 = 7.8137e-04
Validation rmse = 2.376504
Epoch 5
Loss = 5.6011e-03, PNorm = 34.1784, GNorm = 10.4424, lr_0 = 7.1969e-04
Validation rmse = 2.021724
Epoch 6
Loss = 4.0575e-03, PNorm = 34.2156, GNorm = 5.0893, lr_0 = 6.6287e-04
Validation rmse = 1.701780
Epoch 7
Loss = 2.6162e-03, PNorm = 34.2545, GNorm = 1.0179, lr_0 = 6.1054e-04
Validation rmse = 1.489610
Epoch 8
Loss = 2.1986e-03, PNorm = 34.2814, GNorm = 0.9567, lr_0 = 5.6234e-04
Validation rmse = 1.343251
Epoch 9
Loss = 1.9092e-03, PNorm = 34.3040, GNorm = 1.0443, lr_0 = 5.1795e-04
Validation rmse = 1.340476
Epoch 10
Loss = 2.0175e-03, PNorm = 34.3228, GNorm = 2.5147, lr_0 = 4.7706e-04
Validation rmse = 1.276724
Epoch 11
Loss = 1.6269e-03, PNorm = 34.3383, GNorm = 1.4316, lr_0 = 4.3940e-04
Validation rmse = 1.236094
Epoch 12
Loss = 1.5780e-03, PNorm = 34.3557, GNorm = 1.6711, lr_0 = 4.0471e-04
Validation rmse = 1.215717
Epoch 13
Loss = 1.5029e-03, PNorm = 34.3676, GNorm = 2.0301, lr_0 = 3.7276e-04
Validation rmse = 1.214417
Epoch 14
Loss = 1.3616e-03, PNorm = 34.3801, GNorm = 2.6949, lr_0 = 3.4333e-04
Validation rmse = 1.222242
Epoch 15
Loss = 1.4126e-03, PNorm = 34.3925, GNorm = 1.5631, lr_0 = 3.1623e-04
Validation rmse = 1.151079
Epoch 16
Loss = 1.2244e-03, PNorm = 34.4020, GNorm = 1.6841, lr_0 = 2.9126e-04
Validation rmse = 1.135777
Epoch 17
Loss = 1.1785e-03, PNorm = 34.4133, GNorm = 1.2579, lr_0 = 2.6827e-04
Validation rmse = 1.146683
Epoch 18
Loss = 1.1404e-03, PNorm = 34.4237, GNorm = 0.7267, lr_0 = 2.4709e-04
Validation rmse = 1.137128
Epoch 19
Loss = 1.0849e-03, PNorm = 34.4316, GNorm = 1.4081, lr_0 = 2.2758e-04
Validation rmse = 1.127498
Epoch 20
Loss = 1.0265e-03, PNorm = 34.4402, GNorm = 1.2604, lr_0 = 2.0962e-04
Validation rmse = 1.127711
Epoch 21
Loss = 1.0393e-03, PNorm = 34.4481, GNorm = 0.7828, lr_0 = 1.9307e-04
Validation rmse = 1.146610
Epoch 22
Loss = 9.7635e-04, PNorm = 34.4554, GNorm = 1.4098, lr_0 = 1.7783e-04
Validation rmse = 1.091237
Epoch 23
Loss = 8.9793e-04, PNorm = 34.4623, GNorm = 0.5693, lr_0 = 1.6379e-04
Validation rmse = 1.096649
Epoch 24
Loss = 9.3670e-04, PNorm = 34.4684, GNorm = 1.1161, lr_0 = 1.5086e-04
Validation rmse = 1.098293
Epoch 25
Loss = 9.0263e-04, PNorm = 34.4739, GNorm = 0.8109, lr_0 = 1.3895e-04
Validation rmse = 1.088506
Epoch 26
Loss = 8.3121e-04, PNorm = 34.4796, GNorm = 0.9235, lr_0 = 1.2798e-04
Validation rmse = 1.091955
Epoch 27
Loss = 8.8007e-04, PNorm = 34.4850, GNorm = 0.6863, lr_0 = 1.1788e-04
Validation rmse = 1.073289
Epoch 28
Loss = 8.5765e-04, PNorm = 34.4893, GNorm = 1.1061, lr_0 = 1.0857e-04
Validation rmse = 1.104097
Epoch 29
Loss = 8.6965e-04, PNorm = 34.4936, GNorm = 1.7266, lr_0 = 1.0000e-04
Validation rmse = 1.063855
Model 0 best validation rmse = 1.063855 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.936416
Ensemble test rmse = 0.936416
1-fold cross validation
Seed 0 ==> test rmse = 0.936416
Overall test rmse = 0.936416 +/- 0.000000
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/freesolv.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 3,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'examples/freesolv/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 642 | train size = 513 | val size = 64 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 2.0633e-02, PNorm = 33.9176, GNorm = 1.8257, lr_0 = 5.5000e-04
Validation rmse = 3.116298
Epoch 1
Loss = 1.4815e-02, PNorm = 33.9462, GNorm = 1.4063, lr_0 = 1.0000e-03
Validation rmse = 2.994672
Epoch 2
Loss = 1.1073e-02, PNorm = 34.0026, GNorm = 2.3905, lr_0 = 9.2106e-04
Validation rmse = 2.326536
Epoch 3
Loss = 9.1032e-03, PNorm = 34.0575, GNorm = 14.9423, lr_0 = 8.4834e-04
Validation rmse = 1.963077
Epoch 4
Loss = 7.3434e-03, PNorm = 34.0957, GNorm = 1.1028, lr_0 = 7.8137e-04
Validation rmse = 2.180189
Epoch 5
Loss = 6.5681e-03, PNorm = 34.1386, GNorm = 0.8162, lr_0 = 7.1969e-04
Validation rmse = 1.794037
Epoch 6
Loss = 3.8687e-03, PNorm = 34.1767, GNorm = 3.1828, lr_0 = 6.6287e-04
Validation rmse = 1.640643
Epoch 7
Loss = 3.1011e-03, PNorm = 34.2080, GNorm = 3.2480, lr_0 = 6.1054e-04
Validation rmse = 1.450519
Epoch 8
Loss = 2.7751e-03, PNorm = 34.2325, GNorm = 3.3559, lr_0 = 5.6234e-04
Validation rmse = 1.399965
Epoch 9
Loss = 2.1329e-03, PNorm = 34.2549, GNorm = 1.2270, lr_0 = 5.1795e-04
Validation rmse = 1.333905
Epoch 10
Loss = 2.0001e-03, PNorm = 34.2716, GNorm = 2.3271, lr_0 = 4.7706e-04
Validation rmse = 1.300180
Epoch 11
Loss = 1.6457e-03, PNorm = 34.2841, GNorm = 1.6999, lr_0 = 4.3940e-04
Validation rmse = 1.329094
Epoch 12
Loss = 1.7099e-03, PNorm = 34.2982, GNorm = 2.9681, lr_0 = 4.0471e-04
Validation rmse = 1.249971
Epoch 13
Loss = 1.5239e-03, PNorm = 34.3076, GNorm = 1.5262, lr_0 = 3.7276e-04
Validation rmse = 1.208590
Epoch 14
Loss = 1.3351e-03, PNorm = 34.3171, GNorm = 0.8457, lr_0 = 3.4333e-04
Validation rmse = 1.219378
Epoch 15
Loss = 1.3826e-03, PNorm = 34.3273, GNorm = 0.6895, lr_0 = 3.1623e-04
Validation rmse = 1.174092
Epoch 16
Loss = 1.2995e-03, PNorm = 34.3348, GNorm = 1.6098, lr_0 = 2.9126e-04
Validation rmse = 1.149456
Epoch 17
Loss = 1.2289e-03, PNorm = 34.3436, GNorm = 1.1042, lr_0 = 2.6827e-04
Validation rmse = 1.166683
Epoch 18
Loss = 1.1924e-03, PNorm = 34.3518, GNorm = 0.4900, lr_0 = 2.4709e-04
Validation rmse = 1.156523
Epoch 19
Loss = 1.1384e-03, PNorm = 34.3583, GNorm = 0.7971, lr_0 = 2.2758e-04
Validation rmse = 1.145490
Epoch 20
Loss = 1.0816e-03, PNorm = 34.3650, GNorm = 1.7494, lr_0 = 2.0962e-04
Validation rmse = 1.136094
Epoch 21
Loss = 1.0730e-03, PNorm = 34.3710, GNorm = 0.4529, lr_0 = 1.9307e-04
Validation rmse = 1.152865
Epoch 22
Loss = 1.0322e-03, PNorm = 34.3766, GNorm = 1.3354, lr_0 = 1.7783e-04
Validation rmse = 1.106305
Epoch 23
Loss = 9.4529e-04, PNorm = 34.3822, GNorm = 0.6437, lr_0 = 1.6379e-04
Validation rmse = 1.122055
Epoch 24
Loss = 9.9649e-04, PNorm = 34.3871, GNorm = 1.0720, lr_0 = 1.5086e-04
Validation rmse = 1.124168
Epoch 25
Loss = 9.5846e-04, PNorm = 34.3914, GNorm = 0.7746, lr_0 = 1.3895e-04
Validation rmse = 1.113644
Epoch 26
Loss = 8.9615e-04, PNorm = 34.3961, GNorm = 0.5428, lr_0 = 1.2798e-04
Validation rmse = 1.113564
Epoch 27
Loss = 9.4149e-04, PNorm = 34.4005, GNorm = 0.7579, lr_0 = 1.1788e-04
Validation rmse = 1.101406
Epoch 28
Loss = 9.1545e-04, PNorm = 34.4042, GNorm = 0.4758, lr_0 = 1.0857e-04
Validation rmse = 1.103637
Epoch 29
Loss = 9.1531e-04, PNorm = 34.4078, GNorm = 1.4900, lr_0 = 1.0000e-04
Validation rmse = 1.112177
Model 0 best validation rmse = 1.101406 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.939629
Ensemble test rmse = 0.939629
Fold 1
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/freesolv.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 3,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': False,
 'save_dir': 'examples/freesolv/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'task_names': ['freesolv'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 513,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 642 | train size = 513 | val size = 64 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.7629e-02, PNorm = 33.9127, GNorm = 2.7857, lr_0 = 5.5000e-04
Validation rmse = 3.826566
Epoch 1
Loss = 1.2813e-02, PNorm = 33.9510, GNorm = 1.5531, lr_0 = 1.0000e-03
Validation rmse = 4.424192
Epoch 2
Loss = 1.0774e-02, PNorm = 33.9993, GNorm = 2.1289, lr_0 = 9.2106e-04
Validation rmse = 3.165999
Epoch 3
Loss = 7.9244e-03, PNorm = 34.0512, GNorm = 5.7806, lr_0 = 8.4834e-04
Validation rmse = 2.342705
Epoch 4
Loss = 5.7727e-03, PNorm = 34.0944, GNorm = 0.9623, lr_0 = 7.8137e-04
Validation rmse = 2.204747
Epoch 5
Loss = 3.8124e-03, PNorm = 34.1460, GNorm = 1.5836, lr_0 = 7.1969e-04
Validation rmse = 1.683793
Epoch 6
Loss = 2.9189e-03, PNorm = 34.1854, GNorm = 2.5425, lr_0 = 6.6287e-04
Validation rmse = 1.609067
Epoch 7
Loss = 2.6414e-03, PNorm = 34.2182, GNorm = 1.2439, lr_0 = 6.1054e-04
Validation rmse = 1.436545
Epoch 8
Loss = 1.9512e-03, PNorm = 34.2413, GNorm = 1.4990, lr_0 = 5.6234e-04
Validation rmse = 1.433816
Epoch 9
Loss = 1.7723e-03, PNorm = 34.2619, GNorm = 4.4346, lr_0 = 5.1795e-04
Validation rmse = 1.300631
Epoch 10
Loss = 1.5860e-03, PNorm = 34.2750, GNorm = 1.5817, lr_0 = 4.7706e-04
Validation rmse = 1.441077
Epoch 11
Loss = 1.4602e-03, PNorm = 34.2912, GNorm = 0.9739, lr_0 = 4.3940e-04
Validation rmse = 1.252561
Epoch 12
Loss = 1.4150e-03, PNorm = 34.3061, GNorm = 0.8218, lr_0 = 4.0471e-04
Validation rmse = 1.193368
Epoch 13
Loss = 1.3544e-03, PNorm = 34.3174, GNorm = 1.5443, lr_0 = 3.7276e-04
Validation rmse = 1.214360
Epoch 14
Loss = 1.2423e-03, PNorm = 34.3300, GNorm = 1.6919, lr_0 = 3.4333e-04
Validation rmse = 1.188477
Epoch 15
Loss = 1.1020e-03, PNorm = 34.3401, GNorm = 0.5450, lr_0 = 3.1623e-04
Validation rmse = 1.246117
Epoch 16
Loss = 1.0765e-03, PNorm = 34.3514, GNorm = 3.1356, lr_0 = 2.9126e-04
Validation rmse = 1.165116
Epoch 17
Loss = 1.1165e-03, PNorm = 34.3605, GNorm = 3.1847, lr_0 = 2.6827e-04
Validation rmse = 1.278698
Epoch 18
Loss = 9.9874e-04, PNorm = 34.3702, GNorm = 0.9471, lr_0 = 2.4709e-04
Validation rmse = 1.128906
Epoch 19
Loss = 1.2348e-03, PNorm = 34.3782, GNorm = 3.4968, lr_0 = 2.2758e-04
Validation rmse = 1.170076
Epoch 20
Loss = 1.0752e-03, PNorm = 34.3861, GNorm = 1.7574, lr_0 = 2.0962e-04
Validation rmse = 1.256521
Epoch 21
Loss = 1.2152e-03, PNorm = 34.3930, GNorm = 1.0581, lr_0 = 1.9307e-04
Validation rmse = 1.338269
Epoch 22
Loss = 1.1411e-03, PNorm = 34.4003, GNorm = 1.9496, lr_0 = 1.7783e-04
Validation rmse = 1.343203
Epoch 23
Loss = 9.5507e-04, PNorm = 34.4070, GNorm = 2.7182, lr_0 = 1.6379e-04
Validation rmse = 1.161315
Epoch 24
Loss = 8.8012e-04, PNorm = 34.4126, GNorm = 1.7526, lr_0 = 1.5086e-04
Validation rmse = 1.191390
Epoch 25
Loss = 8.8580e-04, PNorm = 34.4182, GNorm = 0.7259, lr_0 = 1.3895e-04
Validation rmse = 1.131255
Epoch 26
Loss = 8.1506e-04, PNorm = 34.4226, GNorm = 2.8427, lr_0 = 1.2798e-04
Validation rmse = 1.185039
Epoch 27
Loss = 7.8448e-04, PNorm = 34.4266, GNorm = 1.1404, lr_0 = 1.1788e-04
Validation rmse = 1.237760
Epoch 28
Loss = 8.7076e-04, PNorm = 34.4304, GNorm = 0.5071, lr_0 = 1.0857e-04
Validation rmse = 1.182691
Epoch 29
Loss = 8.0353e-04, PNorm = 34.4333, GNorm = 0.7203, lr_0 = 1.0000e-04
Validation rmse = 1.138744
Model 0 best validation rmse = 1.128906 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 1.018122
Ensemble test rmse = 1.018122
Fold 2
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/freesolv.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 3,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': False,
 'save_dir': 'examples/freesolv/fold_2',
 'save_smiles_splits': False,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'task_names': ['freesolv'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 513,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 642 | train size = 513 | val size = 64 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.7860e-02, PNorm = 33.9457, GNorm = 1.7009, lr_0 = 5.5000e-04
Validation rmse = 4.584611
Epoch 1
Loss = 1.3710e-02, PNorm = 33.9790, GNorm = 8.0458, lr_0 = 1.0000e-03
Validation rmse = 4.896218
Epoch 2
Loss = 1.4170e-02, PNorm = 34.0216, GNorm = 5.3773, lr_0 = 9.2106e-04
Validation rmse = 4.300604
Epoch 3
Loss = 1.1669e-02, PNorm = 34.0717, GNorm = 5.1275, lr_0 = 8.4834e-04
Validation rmse = 4.085158
Epoch 4
Loss = 8.6444e-03, PNorm = 34.1296, GNorm = 1.1989, lr_0 = 7.8137e-04
Validation rmse = 3.419493
Epoch 5
Loss = 5.5240e-03, PNorm = 34.1913, GNorm = 2.1833, lr_0 = 7.1969e-04
Validation rmse = 2.653867
Epoch 6
Loss = 4.1558e-03, PNorm = 34.2464, GNorm = 3.0639, lr_0 = 6.6287e-04
Validation rmse = 2.233595
Epoch 7
Loss = 2.8525e-03, PNorm = 34.2865, GNorm = 1.4378, lr_0 = 6.1054e-04
Validation rmse = 2.015511
Epoch 8
Loss = 2.1805e-03, PNorm = 34.3222, GNorm = 0.6697, lr_0 = 5.6234e-04
Validation rmse = 1.638545
Epoch 9
Loss = 1.8575e-03, PNorm = 34.3422, GNorm = 1.1799, lr_0 = 5.1795e-04
Validation rmse = 1.641270
Epoch 10
Loss = 1.7550e-03, PNorm = 34.3586, GNorm = 3.0980, lr_0 = 4.7706e-04
Validation rmse = 1.569004
Epoch 11
Loss = 1.8349e-03, PNorm = 34.3718, GNorm = 3.8182, lr_0 = 4.3940e-04
Validation rmse = 1.784607
Epoch 12
Loss = 1.8543e-03, PNorm = 34.3882, GNorm = 2.8887, lr_0 = 4.0471e-04
Validation rmse = 1.464839
Epoch 13
Loss = 1.4648e-03, PNorm = 34.3988, GNorm = 2.0303, lr_0 = 3.7276e-04
Validation rmse = 1.454809
Epoch 14
Loss = 1.5424e-03, PNorm = 34.4090, GNorm = 1.7866, lr_0 = 3.4333e-04
Validation rmse = 1.415424
Epoch 15
Loss = 1.5933e-03, PNorm = 34.4200, GNorm = 2.9328, lr_0 = 3.1623e-04
Validation rmse = 1.411818
Epoch 16
Loss = 1.3691e-03, PNorm = 34.4287, GNorm = 0.5860, lr_0 = 2.9126e-04
Validation rmse = 1.457392
Epoch 17
Loss = 1.2968e-03, PNorm = 34.4386, GNorm = 1.9076, lr_0 = 2.6827e-04
Validation rmse = 1.454297
Epoch 18
Loss = 1.1650e-03, PNorm = 34.4484, GNorm = 1.1966, lr_0 = 2.4709e-04
Validation rmse = 1.450642
Epoch 19
Loss = 1.0340e-03, PNorm = 34.4567, GNorm = 1.2451, lr_0 = 2.2758e-04
Validation rmse = 1.351576
Epoch 20
Loss = 1.0798e-03, PNorm = 34.4644, GNorm = 0.8108, lr_0 = 2.0962e-04
Validation rmse = 1.331966
Epoch 21
Loss = 9.9626e-04, PNorm = 34.4715, GNorm = 0.5623, lr_0 = 1.9307e-04
Validation rmse = 1.423800
Epoch 22
Loss = 9.5118e-04, PNorm = 34.4780, GNorm = 0.6356, lr_0 = 1.7783e-04
Validation rmse = 1.359801
Epoch 23
Loss = 9.4250e-04, PNorm = 34.4844, GNorm = 0.6851, lr_0 = 1.6379e-04
Validation rmse = 1.378125
Epoch 24
Loss = 9.3720e-04, PNorm = 34.4899, GNorm = 0.6217, lr_0 = 1.5086e-04
Validation rmse = 1.392844
Epoch 25
Loss = 9.0016e-04, PNorm = 34.4956, GNorm = 1.2709, lr_0 = 1.3895e-04
Validation rmse = 1.432555
Epoch 26
Loss = 9.1422e-04, PNorm = 34.5008, GNorm = 0.4093, lr_0 = 1.2798e-04
Validation rmse = 1.442575
Epoch 27
Loss = 8.2650e-04, PNorm = 34.5053, GNorm = 0.8125, lr_0 = 1.1788e-04
Validation rmse = 1.350681
Epoch 28
Loss = 8.3786e-04, PNorm = 34.5095, GNorm = 0.5446, lr_0 = 1.0857e-04
Validation rmse = 1.359407
Epoch 29
Loss = 8.1274e-04, PNorm = 34.5135, GNorm = 1.2419, lr_0 = 1.0000e-04
Validation rmse = 1.356880
Model 0 best validation rmse = 1.331966 on epoch 20
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 1.416942
Ensemble test rmse = 1.416942
3-fold cross validation
Seed 0 ==> test rmse = 0.939629
Seed 1 ==> test rmse = 1.018122
Seed 2 ==> test rmse = 1.416942
Overall test rmse = 1.124898 +/- 0.208978
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/freesolv.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 3,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'examples/freesolv/fold_0',
 'save_smiles_splits': False,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 642 | train size = 513 | val size = 64 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.6677e-02, PNorm = 34.0075, GNorm = 1.8328, lr_0 = 5.5000e-04
Validation rmse = 4.480321
Epoch 1
Loss = 1.2820e-02, PNorm = 34.0441, GNorm = 7.6643, lr_0 = 1.0000e-03
Validation rmse = 4.853710
Epoch 2
Loss = 1.3397e-02, PNorm = 34.0879, GNorm = 3.8596, lr_0 = 9.2106e-04
Validation rmse = 4.077447
Epoch 3
Loss = 1.0789e-02, PNorm = 34.1362, GNorm = 6.6019, lr_0 = 8.4834e-04
Validation rmse = 4.005007
Epoch 4
Loss = 8.3269e-03, PNorm = 34.1942, GNorm = 2.0804, lr_0 = 7.8137e-04
Validation rmse = 3.594736
Epoch 5
Loss = 5.6515e-03, PNorm = 34.2500, GNorm = 2.2279, lr_0 = 7.1969e-04
Validation rmse = 2.959245
Epoch 6
Loss = 4.3397e-03, PNorm = 34.2989, GNorm = 2.3766, lr_0 = 6.6287e-04
Validation rmse = 2.684940
Epoch 7
Loss = 3.2509e-03, PNorm = 34.3397, GNorm = 3.9138, lr_0 = 6.1054e-04
Validation rmse = 2.374543
Epoch 8
Loss = 2.4953e-03, PNorm = 34.3753, GNorm = 0.6814, lr_0 = 5.6234e-04
Validation rmse = 1.846285
Epoch 9
Loss = 2.0566e-03, PNorm = 34.4008, GNorm = 1.1663, lr_0 = 5.1795e-04
Validation rmse = 1.721906
Epoch 10
Loss = 1.8962e-03, PNorm = 34.4190, GNorm = 2.9118, lr_0 = 4.7706e-04
Validation rmse = 1.620681
Epoch 11
Loss = 1.8859e-03, PNorm = 34.4325, GNorm = 3.1177, lr_0 = 4.3940e-04
Validation rmse = 1.864836
Epoch 12
Loss = 1.8503e-03, PNorm = 34.4496, GNorm = 1.7204, lr_0 = 4.0471e-04
Validation rmse = 1.550950
Epoch 13
Loss = 1.5038e-03, PNorm = 34.4611, GNorm = 1.6215, lr_0 = 3.7276e-04
Validation rmse = 1.483962
Epoch 14
Loss = 1.5629e-03, PNorm = 34.4720, GNorm = 1.1175, lr_0 = 3.4333e-04
Validation rmse = 1.441815
Epoch 15
Loss = 1.6224e-03, PNorm = 34.4833, GNorm = 2.9472, lr_0 = 3.1623e-04
Validation rmse = 1.435125
Epoch 16
Loss = 1.3973e-03, PNorm = 34.4924, GNorm = 0.4558, lr_0 = 2.9126e-04
Validation rmse = 1.470550
Epoch 17
Loss = 1.3313e-03, PNorm = 34.5030, GNorm = 1.6572, lr_0 = 2.6827e-04
Validation rmse = 1.448559
Epoch 18
Loss = 1.2400e-03, PNorm = 34.5131, GNorm = 0.8991, lr_0 = 2.4709e-04
Validation rmse = 1.451241
Epoch 19
Loss = 1.1031e-03, PNorm = 34.5217, GNorm = 1.3152, lr_0 = 2.2758e-04
Validation rmse = 1.324256
Epoch 20
Loss = 1.1312e-03, PNorm = 34.5295, GNorm = 0.8997, lr_0 = 2.0962e-04
Validation rmse = 1.301763
Epoch 21
Loss = 1.0650e-03, PNorm = 34.5368, GNorm = 0.9912, lr_0 = 1.9307e-04
Validation rmse = 1.382489
Epoch 22
Loss = 1.0216e-03, PNorm = 34.5435, GNorm = 0.7343, lr_0 = 1.7783e-04
Validation rmse = 1.318270
Epoch 23
Loss = 1.0067e-03, PNorm = 34.5499, GNorm = 0.8320, lr_0 = 1.6379e-04
Validation rmse = 1.321851
Epoch 24
Loss = 9.9966e-04, PNorm = 34.5555, GNorm = 0.7614, lr_0 = 1.5086e-04
Validation rmse = 1.326550
Epoch 25
Loss = 9.7346e-04, PNorm = 34.5610, GNorm = 1.2760, lr_0 = 1.3895e-04
Validation rmse = 1.381828
Epoch 26
Loss = 9.8952e-04, PNorm = 34.5662, GNorm = 0.3387, lr_0 = 1.2798e-04
Validation rmse = 1.401099
Epoch 27
Loss = 9.0298e-04, PNorm = 34.5708, GNorm = 1.0887, lr_0 = 1.1788e-04
Validation rmse = 1.288396
Epoch 28
Loss = 9.0898e-04, PNorm = 34.5750, GNorm = 0.5369, lr_0 = 1.0857e-04
Validation rmse = 1.291535
Epoch 29
Loss = 8.8138e-04, PNorm = 34.5789, GNorm = 1.4685, lr_0 = 1.0000e-04
Validation rmse = 1.294461
Model 0 best validation rmse = 1.288396 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 1.348955
Ensemble test rmse = 1.348955
Fold 1
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/freesolv.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 3,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': False,
 'save_dir': 'examples/freesolv/fold_1',
 'save_smiles_splits': False,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'task_names': ['freesolv'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 513,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 642 | train size = 513 | val size = 64 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.5953e-02, PNorm = 34.0041, GNorm = 2.6781, lr_0 = 5.5000e-04
Validation rmse = 2.807896
Epoch 1
Loss = 1.1903e-02, PNorm = 34.0387, GNorm = 9.8613, lr_0 = 1.0000e-03
Validation rmse = 2.147857
Epoch 2
Loss = 7.9323e-03, PNorm = 34.0924, GNorm = 10.7517, lr_0 = 9.2106e-04
Validation rmse = 1.815828
Epoch 3
Loss = 5.0020e-03, PNorm = 34.1434, GNorm = 10.7629, lr_0 = 8.4834e-04
Validation rmse = 1.458544
Epoch 4
Loss = 4.3919e-03, PNorm = 34.1873, GNorm = 3.7170, lr_0 = 7.8137e-04
Validation rmse = 1.218264
Epoch 5
Loss = 2.9690e-03, PNorm = 34.2219, GNorm = 2.1358, lr_0 = 7.1969e-04
Validation rmse = 1.501314
Epoch 6
Loss = 2.6230e-03, PNorm = 34.2523, GNorm = 1.4257, lr_0 = 6.6287e-04
Validation rmse = 1.451915
Epoch 7
Loss = 2.1290e-03, PNorm = 34.2762, GNorm = 5.8928, lr_0 = 6.1054e-04
Validation rmse = 1.180459
Epoch 8
Loss = 2.1286e-03, PNorm = 34.2918, GNorm = 4.4927, lr_0 = 5.6234e-04
Validation rmse = 1.346157
Epoch 9
Loss = 1.6689e-03, PNorm = 34.3054, GNorm = 1.4608, lr_0 = 5.1795e-04
Validation rmse = 1.147306
Epoch 10
Loss = 1.5755e-03, PNorm = 34.3172, GNorm = 4.9183, lr_0 = 4.7706e-04
Validation rmse = 1.331587
Epoch 11
Loss = 1.6788e-03, PNorm = 34.3274, GNorm = 1.5254, lr_0 = 4.3940e-04
Validation rmse = 1.222280
Epoch 12
Loss = 1.3803e-03, PNorm = 34.3394, GNorm = 1.4969, lr_0 = 4.0471e-04
Validation rmse = 1.134088
Epoch 13
Loss = 1.2214e-03, PNorm = 34.3466, GNorm = 1.1424, lr_0 = 3.7276e-04
Validation rmse = 1.023728
Epoch 14
Loss = 1.2419e-03, PNorm = 34.3563, GNorm = 0.7001, lr_0 = 3.4333e-04
Validation rmse = 1.265439
Epoch 15
Loss = 1.1717e-03, PNorm = 34.3642, GNorm = 3.9261, lr_0 = 3.1623e-04
Validation rmse = 1.205203
Epoch 16
Loss = 1.0658e-03, PNorm = 34.3717, GNorm = 1.1401, lr_0 = 2.9126e-04
Validation rmse = 1.111863
Epoch 17
Loss = 9.9730e-04, PNorm = 34.3794, GNorm = 1.0066, lr_0 = 2.6827e-04
Validation rmse = 1.210373
Epoch 18
Loss = 9.6078e-04, PNorm = 34.3856, GNorm = 2.2368, lr_0 = 2.4709e-04
Validation rmse = 1.103383
Epoch 19
Loss = 9.2569e-04, PNorm = 34.3920, GNorm = 0.8212, lr_0 = 2.2758e-04
Validation rmse = 1.095574
Epoch 20
Loss = 8.8960e-04, PNorm = 34.3989, GNorm = 0.8098, lr_0 = 2.0962e-04
Validation rmse = 1.136429
Epoch 21
Loss = 8.6104e-04, PNorm = 34.4037, GNorm = 0.4418, lr_0 = 1.9307e-04
Validation rmse = 1.063033
Epoch 22
Loss = 9.9121e-04, PNorm = 34.4094, GNorm = 2.5198, lr_0 = 1.7783e-04
Validation rmse = 1.072518
Epoch 23
Loss = 9.7979e-04, PNorm = 34.4140, GNorm = 2.1053, lr_0 = 1.6379e-04
Validation rmse = 1.084662
Epoch 24
Loss = 8.8027e-04, PNorm = 34.4181, GNorm = 2.6388, lr_0 = 1.5086e-04
Validation rmse = 1.067053
Epoch 25
Loss = 8.0252e-04, PNorm = 34.4229, GNorm = 2.6348, lr_0 = 1.3895e-04
Validation rmse = 1.141255
Epoch 26
Loss = 8.4553e-04, PNorm = 34.4269, GNorm = 1.3094, lr_0 = 1.2798e-04
Validation rmse = 1.098156
Epoch 27
Loss = 7.7824e-04, PNorm = 34.4302, GNorm = 1.1181, lr_0 = 1.1788e-04
Validation rmse = 1.130138
Epoch 28
Loss = 8.0514e-04, PNorm = 34.4337, GNorm = 0.8890, lr_0 = 1.0857e-04
Validation rmse = 1.098948
Epoch 29
Loss = 7.4329e-04, PNorm = 34.4367, GNorm = 1.3570, lr_0 = 1.0000e-04
Validation rmse = 1.217015
Model 0 best validation rmse = 1.023728 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 1.535681
Ensemble test rmse = 1.535681
Fold 2
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/freesolv.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 3,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': False,
 'save_dir': 'examples/freesolv/fold_2',
 'save_smiles_splits': False,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'task_names': ['freesolv'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 513,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 642 | train size = 513 | val size = 64 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.6773e-02, PNorm = 33.9589, GNorm = 2.4980, lr_0 = 5.5000e-04
Validation rmse = 3.527140
Epoch 1
Loss = 1.3925e-02, PNorm = 33.9940, GNorm = 6.1817, lr_0 = 1.0000e-03
Validation rmse = 3.205576
Epoch 2
Loss = 8.8867e-03, PNorm = 34.0515, GNorm = 1.4441, lr_0 = 9.2106e-04
Validation rmse = 2.775995
Epoch 3
Loss = 6.8318e-03, PNorm = 34.1060, GNorm = 1.8447, lr_0 = 8.4834e-04
Validation rmse = 2.255744
Epoch 4
Loss = 5.2031e-03, PNorm = 34.1578, GNorm = 8.7727, lr_0 = 7.8137e-04
Validation rmse = 2.102222
Epoch 5
Loss = 4.1374e-03, PNorm = 34.1969, GNorm = 3.8235, lr_0 = 7.1969e-04
Validation rmse = 1.885962
Epoch 6
Loss = 2.7821e-03, PNorm = 34.2347, GNorm = 2.2697, lr_0 = 6.6287e-04
Validation rmse = 1.721959
Epoch 7
Loss = 2.2215e-03, PNorm = 34.2618, GNorm = 1.3340, lr_0 = 6.1054e-04
Validation rmse = 1.661025
Epoch 8
Loss = 1.8844e-03, PNorm = 34.2845, GNorm = 1.2221, lr_0 = 5.6234e-04
Validation rmse = 1.496924
Epoch 9
Loss = 1.7495e-03, PNorm = 34.2980, GNorm = 0.6243, lr_0 = 5.1795e-04
Validation rmse = 1.612835
Epoch 10
Loss = 1.7350e-03, PNorm = 34.3101, GNorm = 0.9158, lr_0 = 4.7706e-04
Validation rmse = 1.539161
Epoch 11
Loss = 1.6387e-03, PNorm = 34.3230, GNorm = 0.7912, lr_0 = 4.3940e-04
Validation rmse = 1.650345
Epoch 12
Loss = 1.3678e-03, PNorm = 34.3352, GNorm = 1.4432, lr_0 = 4.0471e-04
Validation rmse = 1.577234
Epoch 13
Loss = 1.3455e-03, PNorm = 34.3438, GNorm = 1.5901, lr_0 = 3.7276e-04
Validation rmse = 1.505464
Epoch 14
Loss = 1.3679e-03, PNorm = 34.3528, GNorm = 2.6912, lr_0 = 3.4333e-04
Validation rmse = 1.532632
Epoch 15
Loss = 1.1765e-03, PNorm = 34.3630, GNorm = 4.5448, lr_0 = 3.1623e-04
Validation rmse = 1.717808
Epoch 16
Loss = 1.3929e-03, PNorm = 34.3739, GNorm = 1.2886, lr_0 = 2.9126e-04
Validation rmse = 1.536913
Epoch 17
Loss = 1.0669e-03, PNorm = 34.3808, GNorm = 0.5513, lr_0 = 2.6827e-04
Validation rmse = 1.514928
Epoch 18
Loss = 1.0035e-03, PNorm = 34.3875, GNorm = 2.6746, lr_0 = 2.4709e-04
Validation rmse = 1.534253
Epoch 19
Loss = 9.8359e-04, PNorm = 34.3952, GNorm = 0.8931, lr_0 = 2.2758e-04
Validation rmse = 1.534063
Epoch 20
Loss = 8.6940e-04, PNorm = 34.4010, GNorm = 1.8918, lr_0 = 2.0962e-04
Validation rmse = 1.484139
Epoch 21
Loss = 9.2816e-04, PNorm = 34.4079, GNorm = 1.6124, lr_0 = 1.9307e-04
Validation rmse = 1.484472
Epoch 22
Loss = 8.7132e-04, PNorm = 34.4135, GNorm = 2.0236, lr_0 = 1.7783e-04
Validation rmse = 1.492789
Epoch 23
Loss = 9.6956e-04, PNorm = 34.4183, GNorm = 2.2528, lr_0 = 1.6379e-04
Validation rmse = 1.473081
Epoch 24
Loss = 9.3307e-04, PNorm = 34.4230, GNorm = 1.8323, lr_0 = 1.5086e-04
Validation rmse = 1.481100
Epoch 25
Loss = 7.9912e-04, PNorm = 34.4269, GNorm = 0.8923, lr_0 = 1.3895e-04
Validation rmse = 1.476482
Epoch 26
Loss = 8.1634e-04, PNorm = 34.4316, GNorm = 1.0603, lr_0 = 1.2798e-04
Validation rmse = 1.471316
Epoch 27
Loss = 7.4849e-04, PNorm = 34.4351, GNorm = 0.5496, lr_0 = 1.1788e-04
Validation rmse = 1.491583
Epoch 28
Loss = 7.6409e-04, PNorm = 34.4383, GNorm = 1.2812, lr_0 = 1.0857e-04
Validation rmse = 1.478227
Epoch 29
Loss = 7.6944e-04, PNorm = 34.4416, GNorm = 1.1026, lr_0 = 1.0000e-04
Validation rmse = 1.456998
Model 0 best validation rmse = 1.456998 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 1.113516
Ensemble test rmse = 1.113516
3-fold cross validation
Seed 2 ==> test rmse = 1.348955
Seed 3 ==> test rmse = 1.535681
Seed 4 ==> test rmse = 1.113516
Overall test rmse = 1.332717 +/- 0.172730
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/freesolv.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 2,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'examples/freesolv/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': True,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 642 | train size = 513 | val size = 64 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.9040e-02, PNorm = 34.0000, GNorm = 1.8512, lr_0 = 5.5000e-04
Validation rmse = 2.934104
Validation freesolv rmse = 2.934104
Epoch 1
Loss = 1.2759e-02, PNorm = 34.0444, GNorm = 3.0469, lr_0 = 1.0000e-03
Validation rmse = 3.302008
Validation freesolv rmse = 3.302008
Epoch 2
Loss = 1.1035e-02, PNorm = 34.0907, GNorm = 3.4828, lr_0 = 9.2106e-04
Validation rmse = 2.246650
Validation freesolv rmse = 2.246650
Epoch 3
Loss = 7.5454e-03, PNorm = 34.1487, GNorm = 11.6327, lr_0 = 8.4834e-04
Validation rmse = 2.150817
Validation freesolv rmse = 2.150817
Epoch 4
Loss = 5.9274e-03, PNorm = 34.1972, GNorm = 1.2197, lr_0 = 7.8137e-04
Validation rmse = 2.075111
Validation freesolv rmse = 2.075111
Epoch 5
Loss = 4.9179e-03, PNorm = 34.2415, GNorm = 4.9587, lr_0 = 7.1969e-04
Validation rmse = 1.938290
Validation freesolv rmse = 1.938290
Epoch 6
Loss = 3.5210e-03, PNorm = 34.2805, GNorm = 2.1766, lr_0 = 6.6287e-04
Validation rmse = 1.576601
Validation freesolv rmse = 1.576601
Epoch 7
Loss = 2.4372e-03, PNorm = 34.3128, GNorm = 0.5771, lr_0 = 6.1054e-04
Validation rmse = 1.442171
Validation freesolv rmse = 1.442171
Epoch 8
Loss = 2.2519e-03, PNorm = 34.3371, GNorm = 1.0896, lr_0 = 5.6234e-04
Validation rmse = 1.365441
Validation freesolv rmse = 1.365441
Epoch 9
Loss = 2.0144e-03, PNorm = 34.3570, GNorm = 1.7018, lr_0 = 5.1795e-04
Validation rmse = 1.235018
Validation freesolv rmse = 1.235018
Epoch 10
Loss = 1.7057e-03, PNorm = 34.3730, GNorm = 1.1836, lr_0 = 4.7706e-04
Validation rmse = 1.212679
Validation freesolv rmse = 1.212679
Epoch 11
Loss = 1.4762e-03, PNorm = 34.3860, GNorm = 1.1387, lr_0 = 4.3940e-04
Validation rmse = 1.226829
Validation freesolv rmse = 1.226829
Epoch 12
Loss = 1.5355e-03, PNorm = 34.4008, GNorm = 2.5389, lr_0 = 4.0471e-04
Validation rmse = 1.162683
Validation freesolv rmse = 1.162683
Epoch 13
Loss = 1.3560e-03, PNorm = 34.4112, GNorm = 0.6329, lr_0 = 3.7276e-04
Validation rmse = 1.152348
Validation freesolv rmse = 1.152348
Epoch 14
Loss = 1.2231e-03, PNorm = 34.4231, GNorm = 2.0361, lr_0 = 3.4333e-04
Validation rmse = 1.226816
Validation freesolv rmse = 1.226816
Epoch 15
Loss = 1.3021e-03, PNorm = 34.4351, GNorm = 1.1155, lr_0 = 3.1623e-04
Validation rmse = 1.136972
Validation freesolv rmse = 1.136972
Epoch 16
Loss = 1.1331e-03, PNorm = 34.4446, GNorm = 1.6631, lr_0 = 2.9126e-04
Validation rmse = 1.124027
Validation freesolv rmse = 1.124027
Epoch 17
Loss = 1.0817e-03, PNorm = 34.4552, GNorm = 1.3366, lr_0 = 2.6827e-04
Validation rmse = 1.129545
Validation freesolv rmse = 1.129545
Epoch 18
Loss = 1.0767e-03, PNorm = 34.4650, GNorm = 0.5238, lr_0 = 2.4709e-04
Validation rmse = 1.128133
Validation freesolv rmse = 1.128133
Epoch 19
Loss = 1.0230e-03, PNorm = 34.4732, GNorm = 0.7017, lr_0 = 2.2758e-04
Validation rmse = 1.126631
Validation freesolv rmse = 1.126631
Epoch 20
Loss = 9.5650e-04, PNorm = 34.4814, GNorm = 1.5503, lr_0 = 2.0962e-04
Validation rmse = 1.120219
Validation freesolv rmse = 1.120219
Epoch 21
Loss = 9.5274e-04, PNorm = 34.4893, GNorm = 0.5021, lr_0 = 1.9307e-04
Validation rmse = 1.130451
Validation freesolv rmse = 1.130451
Epoch 22
Loss = 9.0597e-04, PNorm = 34.4964, GNorm = 1.4649, lr_0 = 1.7783e-04
Validation rmse = 1.099242
Validation freesolv rmse = 1.099242
Epoch 23
Loss = 8.3255e-04, PNorm = 34.5036, GNorm = 0.8066, lr_0 = 1.6379e-04
Validation rmse = 1.099898
Validation freesolv rmse = 1.099898
Epoch 24
Loss = 8.6737e-04, PNorm = 34.5100, GNorm = 0.9216, lr_0 = 1.5086e-04
Validation rmse = 1.105054
Validation freesolv rmse = 1.105054
Epoch 25
Loss = 8.4464e-04, PNorm = 34.5157, GNorm = 0.7350, lr_0 = 1.3895e-04
Validation rmse = 1.102017
Validation freesolv rmse = 1.102017
Epoch 26
Loss = 7.6898e-04, PNorm = 34.5217, GNorm = 0.5453, lr_0 = 1.2798e-04
Validation rmse = 1.106441
Validation freesolv rmse = 1.106441
Epoch 27
Loss = 8.1778e-04, PNorm = 34.5272, GNorm = 0.7586, lr_0 = 1.1788e-04
Validation rmse = 1.093237
Validation freesolv rmse = 1.093237
Epoch 28
Loss = 7.8926e-04, PNorm = 34.5317, GNorm = 0.5215, lr_0 = 1.0857e-04
Validation rmse = 1.107749
Validation freesolv rmse = 1.107749
Epoch 29
Loss = 8.0144e-04, PNorm = 34.5362, GNorm = 1.3407, lr_0 = 1.0000e-04
Validation rmse = 1.093604
Validation freesolv rmse = 1.093604
Model 0 best validation rmse = 1.093237 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.991139
Model 0 test freesolv rmse = 0.991139
Ensemble test rmse = 0.991139
Ensemble test freesolv rmse = 0.991139
Fold 1
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/freesolv.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 2,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': False,
 'save_dir': 'examples/freesolv/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': True,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'task_names': ['freesolv'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 513,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 642 | train size = 513 | val size = 64 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.7600e-02, PNorm = 33.8914, GNorm = 5.7822, lr_0 = 5.5000e-04
Validation rmse = 3.890316
Validation freesolv rmse = 3.890316
Epoch 1
Loss = 1.3195e-02, PNorm = 33.9263, GNorm = 8.4976, lr_0 = 1.0000e-03
Validation rmse = 3.390425
Validation freesolv rmse = 3.390425
Epoch 2
Loss = 1.2075e-02, PNorm = 33.9679, GNorm = 6.0287, lr_0 = 9.2106e-04
Validation rmse = 3.507784
Validation freesolv rmse = 3.507784
Epoch 3
Loss = 8.7667e-03, PNorm = 34.0143, GNorm = 0.8167, lr_0 = 8.4834e-04
Validation rmse = 2.642238
Validation freesolv rmse = 2.642238
Epoch 4
Loss = 5.5140e-03, PNorm = 34.0657, GNorm = 3.3783, lr_0 = 7.8137e-04
Validation rmse = 2.260941
Validation freesolv rmse = 2.260941
Epoch 5
Loss = 3.9776e-03, PNorm = 34.1171, GNorm = 2.0039, lr_0 = 7.1969e-04
Validation rmse = 1.769532
Validation freesolv rmse = 1.769532
Epoch 6
Loss = 2.9455e-03, PNorm = 34.1573, GNorm = 2.5000, lr_0 = 6.6287e-04
Validation rmse = 1.545313
Validation freesolv rmse = 1.545313
Epoch 7
Loss = 2.7470e-03, PNorm = 34.1845, GNorm = 1.0980, lr_0 = 6.1054e-04
Validation rmse = 1.415691
Validation freesolv rmse = 1.415691
Epoch 8
Loss = 1.9912e-03, PNorm = 34.2042, GNorm = 2.1630, lr_0 = 5.6234e-04
Validation rmse = 1.503745
Validation freesolv rmse = 1.503745
Epoch 9
Loss = 1.7790e-03, PNorm = 34.2234, GNorm = 2.8362, lr_0 = 5.1795e-04
Validation rmse = 1.328904
Validation freesolv rmse = 1.328904
Epoch 10
Loss = 1.5744e-03, PNorm = 34.2348, GNorm = 0.7552, lr_0 = 4.7706e-04
Validation rmse = 1.372755
Validation freesolv rmse = 1.372755
Epoch 11
Loss = 1.4163e-03, PNorm = 34.2475, GNorm = 2.3413, lr_0 = 4.3940e-04
Validation rmse = 1.273117
Validation freesolv rmse = 1.273117
Epoch 12
Loss = 1.3559e-03, PNorm = 34.2603, GNorm = 0.8602, lr_0 = 4.0471e-04
Validation rmse = 1.233790
Validation freesolv rmse = 1.233790
Epoch 13
Loss = 1.2205e-03, PNorm = 34.2691, GNorm = 0.8038, lr_0 = 3.7276e-04
Validation rmse = 1.221822
Validation freesolv rmse = 1.221822
Epoch 14
Loss = 1.2385e-03, PNorm = 34.2788, GNorm = 1.4155, lr_0 = 3.4333e-04
Validation rmse = 1.249426
Validation freesolv rmse = 1.249426
Epoch 15
Loss = 1.0949e-03, PNorm = 34.2872, GNorm = 0.5438, lr_0 = 3.1623e-04
Validation rmse = 1.261534
Validation freesolv rmse = 1.261534
Epoch 16
Loss = 1.0843e-03, PNorm = 34.2958, GNorm = 2.5435, lr_0 = 2.9126e-04
Validation rmse = 1.194337
Validation freesolv rmse = 1.194337
Epoch 17
Loss = 1.0879e-03, PNorm = 34.3022, GNorm = 2.3329, lr_0 = 2.6827e-04
Validation rmse = 1.270384
Validation freesolv rmse = 1.270384
Epoch 18
Loss = 9.8144e-04, PNorm = 34.3099, GNorm = 0.6706, lr_0 = 2.4709e-04
Validation rmse = 1.155010
Validation freesolv rmse = 1.155010
Epoch 19
Loss = 1.1489e-03, PNorm = 34.3165, GNorm = 3.7618, lr_0 = 2.2758e-04
Validation rmse = 1.172520
Validation freesolv rmse = 1.172520
Epoch 20
Loss = 1.0880e-03, PNorm = 34.3224, GNorm = 2.3435, lr_0 = 2.0962e-04
Validation rmse = 1.210476
Validation freesolv rmse = 1.210476
Epoch 21
Loss = 1.2633e-03, PNorm = 34.3275, GNorm = 2.0052, lr_0 = 1.9307e-04
Validation rmse = 1.269725
Validation freesolv rmse = 1.269725
Epoch 22
Loss = 1.1170e-03, PNorm = 34.3328, GNorm = 1.0005, lr_0 = 1.7783e-04
Validation rmse = 1.304448
Validation freesolv rmse = 1.304448
Epoch 23
Loss = 9.0404e-04, PNorm = 34.3380, GNorm = 1.3656, lr_0 = 1.6379e-04
Validation rmse = 1.176357
Validation freesolv rmse = 1.176357
Epoch 24
Loss = 8.4415e-04, PNorm = 34.3429, GNorm = 1.0023, lr_0 = 1.5086e-04
Validation rmse = 1.213442
Validation freesolv rmse = 1.213442
Epoch 25
Loss = 8.5753e-04, PNorm = 34.3476, GNorm = 1.1808, lr_0 = 1.3895e-04
Validation rmse = 1.142988
Validation freesolv rmse = 1.142988
Epoch 26
Loss = 8.1724e-04, PNorm = 34.3509, GNorm = 2.5303, lr_0 = 1.2798e-04
Validation rmse = 1.205760
Validation freesolv rmse = 1.205760
Epoch 27
Loss = 7.9772e-04, PNorm = 34.3543, GNorm = 1.2346, lr_0 = 1.1788e-04
Validation rmse = 1.265669
Validation freesolv rmse = 1.265669
Epoch 28
Loss = 8.8200e-04, PNorm = 34.3576, GNorm = 0.4526, lr_0 = 1.0857e-04
Validation rmse = 1.212001
Validation freesolv rmse = 1.212001
Epoch 29
Loss = 8.0878e-04, PNorm = 34.3599, GNorm = 0.8402, lr_0 = 1.0000e-04
Validation rmse = 1.153744
Validation freesolv rmse = 1.153744
Model 0 best validation rmse = 1.142988 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.901352
Model 0 test freesolv rmse = 0.901352
Ensemble test rmse = 0.901352
Ensemble test freesolv rmse = 0.901352
2-fold cross validation
Seed 0 ==> test rmse = 0.991139
Seed 0 ==> test freesolv rmse = 0.991139
Seed 1 ==> test rmse = 0.901352
Seed 1 ==> test freesolv rmse = 0.901352
Overall test rmse = 0.946246 +/- 0.044893
Overall test freesolv rmse = 0.946246 +/- 0.044893
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/freesolv.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 2,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'examples/freesolv/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 642 | train size = 513 | val size = 64 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.9078e-02, PNorm = 33.9288, GNorm = 2.3526, lr_0 = 5.5000e-04
Validation rmse = 3.221763
Epoch 1
Loss = 1.3673e-02, PNorm = 33.9727, GNorm = 2.1826, lr_0 = 1.0000e-03
Validation rmse = 3.370352
Epoch 2
Loss = 1.1622e-02, PNorm = 34.0241, GNorm = 2.9640, lr_0 = 9.2106e-04
Validation rmse = 2.321581
Epoch 3
Loss = 7.8696e-03, PNorm = 34.0875, GNorm = 13.6308, lr_0 = 8.4834e-04
Validation rmse = 1.941618
Epoch 4
Loss = 6.5440e-03, PNorm = 34.1364, GNorm = 6.9554, lr_0 = 7.8137e-04
Validation rmse = 2.684941
Epoch 5
Loss = 6.4521e-03, PNorm = 34.1826, GNorm = 7.0400, lr_0 = 7.1969e-04
Validation rmse = 2.273132
Epoch 6
Loss = 4.4119e-03, PNorm = 34.2278, GNorm = 2.2797, lr_0 = 6.6287e-04
Validation rmse = 1.780865
Epoch 7
Loss = 2.8989e-03, PNorm = 34.2688, GNorm = 0.9830, lr_0 = 6.1054e-04
Validation rmse = 1.539029
Epoch 8
Loss = 2.7138e-03, PNorm = 34.2959, GNorm = 1.5974, lr_0 = 5.6234e-04
Validation rmse = 1.418205
Epoch 9
Loss = 2.2369e-03, PNorm = 34.3188, GNorm = 0.7846, lr_0 = 5.1795e-04
Validation rmse = 1.319173
Epoch 10
Loss = 1.9254e-03, PNorm = 34.3363, GNorm = 1.8790, lr_0 = 4.7706e-04
Validation rmse = 1.290658
Epoch 11
Loss = 1.6427e-03, PNorm = 34.3506, GNorm = 1.7227, lr_0 = 4.3940e-04
Validation rmse = 1.328317
Epoch 12
Loss = 1.6801e-03, PNorm = 34.3666, GNorm = 2.9334, lr_0 = 4.0471e-04
Validation rmse = 1.253553
Epoch 13
Loss = 1.4746e-03, PNorm = 34.3776, GNorm = 1.3278, lr_0 = 3.7276e-04
Validation rmse = 1.199067
Epoch 14
Loss = 1.3072e-03, PNorm = 34.3887, GNorm = 0.8829, lr_0 = 3.4333e-04
Validation rmse = 1.230562
Epoch 15
Loss = 1.3322e-03, PNorm = 34.4013, GNorm = 0.6448, lr_0 = 3.1623e-04
Validation rmse = 1.193152
Epoch 16
Loss = 1.2503e-03, PNorm = 34.4097, GNorm = 1.3174, lr_0 = 2.9126e-04
Validation rmse = 1.168246
Epoch 17
Loss = 1.1846e-03, PNorm = 34.4199, GNorm = 1.2392, lr_0 = 2.6827e-04
Validation rmse = 1.167038
Epoch 18
Loss = 1.1309e-03, PNorm = 34.4290, GNorm = 0.5861, lr_0 = 2.4709e-04
Validation rmse = 1.154394
Epoch 19
Loss = 1.0606e-03, PNorm = 34.4363, GNorm = 0.5576, lr_0 = 2.2758e-04
Validation rmse = 1.153449
Epoch 20
Loss = 1.0059e-03, PNorm = 34.4444, GNorm = 1.7208, lr_0 = 2.0962e-04
Validation rmse = 1.144047
Epoch 21
Loss = 9.8898e-04, PNorm = 34.4518, GNorm = 0.5335, lr_0 = 1.9307e-04
Validation rmse = 1.148865
Epoch 22
Loss = 9.5025e-04, PNorm = 34.4582, GNorm = 1.4794, lr_0 = 1.7783e-04
Validation rmse = 1.118853
Epoch 23
Loss = 8.7511e-04, PNorm = 34.4645, GNorm = 0.5498, lr_0 = 1.6379e-04
Validation rmse = 1.123615
Epoch 24
Loss = 9.1454e-04, PNorm = 34.4703, GNorm = 1.0724, lr_0 = 1.5086e-04
Validation rmse = 1.130313
Epoch 25
Loss = 8.7536e-04, PNorm = 34.4754, GNorm = 0.6960, lr_0 = 1.3895e-04
Validation rmse = 1.116166
Epoch 26
Loss = 8.1538e-04, PNorm = 34.4807, GNorm = 0.4149, lr_0 = 1.2798e-04
Validation rmse = 1.106853
Epoch 27
Loss = 8.5498e-04, PNorm = 34.4857, GNorm = 0.8066, lr_0 = 1.1788e-04
Validation rmse = 1.106243
Epoch 28
Loss = 8.3979e-04, PNorm = 34.4899, GNorm = 0.4511, lr_0 = 1.0857e-04
Validation rmse = 1.103761
Epoch 29
Loss = 8.2037e-04, PNorm = 34.4941, GNorm = 1.4475, lr_0 = 1.0000e-04
Validation rmse = 1.105992
Model 0 best validation rmse = 1.103761 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.970742
Ensemble test rmse = 0.970742
Fold 1
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/freesolv.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 2,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': False,
 'save_dir': 'examples/freesolv/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'task_names': ['freesolv'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 513,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 642 | train size = 513 | val size = 64 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.9044e-02, PNorm = 34.0140, GNorm = 6.0284, lr_0 = 5.5000e-04
Validation rmse = 4.030543
Epoch 1
Loss = 1.2947e-02, PNorm = 34.0503, GNorm = 5.0600, lr_0 = 1.0000e-03
Validation rmse = 3.135770
Epoch 2
Loss = 9.5419e-03, PNorm = 34.1033, GNorm = 1.0632, lr_0 = 9.2106e-04
Validation rmse = 2.870904
Epoch 3
Loss = 6.8881e-03, PNorm = 34.1537, GNorm = 7.6579, lr_0 = 8.4834e-04
Validation rmse = 2.201453
Epoch 4
Loss = 4.5027e-03, PNorm = 34.1987, GNorm = 1.2607, lr_0 = 7.8137e-04
Validation rmse = 2.060549
Epoch 5
Loss = 2.9187e-03, PNorm = 34.2467, GNorm = 2.0974, lr_0 = 7.1969e-04
Validation rmse = 1.487187
Epoch 6
Loss = 2.2948e-03, PNorm = 34.2778, GNorm = 1.2089, lr_0 = 6.6287e-04
Validation rmse = 1.484930
Epoch 7
Loss = 2.1481e-03, PNorm = 34.3007, GNorm = 2.0027, lr_0 = 6.1054e-04
Validation rmse = 1.500225
Epoch 8
Loss = 1.7971e-03, PNorm = 34.3162, GNorm = 3.2844, lr_0 = 5.6234e-04
Validation rmse = 1.353605
Epoch 9
Loss = 1.5984e-03, PNorm = 34.3316, GNorm = 2.2408, lr_0 = 5.1795e-04
Validation rmse = 1.346535
Epoch 10
Loss = 1.4740e-03, PNorm = 34.3420, GNorm = 1.0024, lr_0 = 4.7706e-04
Validation rmse = 1.324720
Epoch 11
Loss = 1.2922e-03, PNorm = 34.3546, GNorm = 2.0622, lr_0 = 4.3940e-04
Validation rmse = 1.261244
Epoch 12
Loss = 1.2421e-03, PNorm = 34.3654, GNorm = 0.8690, lr_0 = 4.0471e-04
Validation rmse = 1.205135
Epoch 13
Loss = 1.1087e-03, PNorm = 34.3731, GNorm = 0.7349, lr_0 = 3.7276e-04
Validation rmse = 1.209990
Epoch 14
Loss = 1.1394e-03, PNorm = 34.3820, GNorm = 1.2034, lr_0 = 3.4333e-04
Validation rmse = 1.209371
Epoch 15
Loss = 1.0330e-03, PNorm = 34.3903, GNorm = 0.4729, lr_0 = 3.1623e-04
Validation rmse = 1.217236
Epoch 16
Loss = 1.0128e-03, PNorm = 34.3984, GNorm = 2.4237, lr_0 = 2.9126e-04
Validation rmse = 1.166788
Epoch 17
Loss = 1.0065e-03, PNorm = 34.4051, GNorm = 1.8765, lr_0 = 2.6827e-04
Validation rmse = 1.230808
Epoch 18
Loss = 9.2401e-04, PNorm = 34.4125, GNorm = 0.6679, lr_0 = 2.4709e-04
Validation rmse = 1.119601
Epoch 19
Loss = 1.0725e-03, PNorm = 34.4190, GNorm = 3.6015, lr_0 = 2.2758e-04
Validation rmse = 1.131235
Epoch 20
Loss = 1.0225e-03, PNorm = 34.4252, GNorm = 2.3798, lr_0 = 2.0962e-04
Validation rmse = 1.157238
Epoch 21
Loss = 1.1360e-03, PNorm = 34.4306, GNorm = 2.1168, lr_0 = 1.9307e-04
Validation rmse = 1.209865
Epoch 22
Loss = 9.4461e-04, PNorm = 34.4364, GNorm = 0.6520, lr_0 = 1.7783e-04
Validation rmse = 1.223764
Epoch 23
Loss = 8.2106e-04, PNorm = 34.4416, GNorm = 1.3241, lr_0 = 1.6379e-04
Validation rmse = 1.128194
Epoch 24
Loss = 7.9278e-04, PNorm = 34.4458, GNorm = 0.9257, lr_0 = 1.5086e-04
Validation rmse = 1.167868
Epoch 25
Loss = 8.0458e-04, PNorm = 34.4502, GNorm = 0.9980, lr_0 = 1.3895e-04
Validation rmse = 1.122782
Epoch 26
Loss = 7.6937e-04, PNorm = 34.4534, GNorm = 2.4418, lr_0 = 1.2798e-04
Validation rmse = 1.161996
Epoch 27
Loss = 7.4550e-04, PNorm = 34.4567, GNorm = 1.2700, lr_0 = 1.1788e-04
Validation rmse = 1.232175
Epoch 28
Loss = 8.1319e-04, PNorm = 34.4598, GNorm = 0.4712, lr_0 = 1.0857e-04
Validation rmse = 1.184845
Epoch 29
Loss = 7.5636e-04, PNorm = 34.4620, GNorm = 0.6562, lr_0 = 1.0000e-04
Validation rmse = 1.126082
Model 0 best validation rmse = 1.119601 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.897125
Ensemble test rmse = 0.897125
2-fold cross validation
Seed 0 ==> test rmse = 0.970742
Seed 1 ==> test rmse = 0.897125
Overall test rmse = 0.933933 +/- 0.036808
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/freesolv.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 2,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 2,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'examples/freesolv/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 642 | train size = 513 | val size = 64 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.9251e-02, PNorm = 33.9689, GNorm = 2.8313, lr_0 = 5.5000e-04
Validation rmse = 3.089115
Epoch 1
Loss = 1.3333e-02, PNorm = 34.0018, GNorm = 3.7692, lr_0 = 1.0000e-03
Validation rmse = 3.367060
Epoch 2
Loss = 1.1503e-02, PNorm = 34.0443, GNorm = 2.9944, lr_0 = 9.2106e-04
Validation rmse = 2.331428
Epoch 3
Loss = 7.0985e-03, PNorm = 34.0970, GNorm = 11.9663, lr_0 = 8.4834e-04
Validation rmse = 2.060228
Epoch 4
Loss = 5.2170e-03, PNorm = 34.1445, GNorm = 4.4473, lr_0 = 7.8137e-04
Validation rmse = 1.778857
Epoch 5
Loss = 3.6336e-03, PNorm = 34.1877, GNorm = 2.0654, lr_0 = 7.1969e-04
Validation rmse = 1.582614
Epoch 6
Loss = 2.6197e-03, PNorm = 34.2196, GNorm = 3.6830, lr_0 = 6.6287e-04
Validation rmse = 1.452045
Epoch 7
Loss = 2.2463e-03, PNorm = 34.2463, GNorm = 0.6300, lr_0 = 6.1054e-04
Validation rmse = 1.378990
Epoch 8
Loss = 2.1408e-03, PNorm = 34.2635, GNorm = 1.8249, lr_0 = 5.6234e-04
Validation rmse = 1.328381
Epoch 9
Loss = 1.7370e-03, PNorm = 34.2822, GNorm = 3.9287, lr_0 = 5.1795e-04
Validation rmse = 1.414189
Epoch 10
Loss = 2.1485e-03, PNorm = 34.2951, GNorm = 5.5077, lr_0 = 4.7706e-04
Validation rmse = 1.691975
Epoch 11
Loss = 2.2500e-03, PNorm = 34.3061, GNorm = 2.1718, lr_0 = 4.3940e-04
Validation rmse = 1.671441
Epoch 12
Loss = 2.2630e-03, PNorm = 34.3210, GNorm = 5.9142, lr_0 = 4.0471e-04
Validation rmse = 1.322465
Epoch 13
Loss = 1.6484e-03, PNorm = 34.3304, GNorm = 0.9619, lr_0 = 3.7276e-04
Validation rmse = 1.298246
Epoch 14
Loss = 1.3860e-03, PNorm = 34.3418, GNorm = 3.3952, lr_0 = 3.4333e-04
Validation rmse = 1.373385
Epoch 15
Loss = 1.4985e-03, PNorm = 34.3523, GNorm = 2.5807, lr_0 = 3.1623e-04
Validation rmse = 1.241376
Epoch 16
Loss = 1.2110e-03, PNorm = 34.3590, GNorm = 1.9920, lr_0 = 2.9126e-04
Validation rmse = 1.222725
Epoch 17
Loss = 1.1634e-03, PNorm = 34.3671, GNorm = 1.7043, lr_0 = 2.6827e-04
Validation rmse = 1.236628
Epoch 18
Loss = 1.1410e-03, PNorm = 34.3745, GNorm = 0.3906, lr_0 = 2.4709e-04
Validation rmse = 1.231845
Epoch 19
Loss = 1.0969e-03, PNorm = 34.3806, GNorm = 1.7419, lr_0 = 2.2758e-04
Validation rmse = 1.234119
Epoch 20
Loss = 1.0448e-03, PNorm = 34.3869, GNorm = 0.9148, lr_0 = 2.0962e-04
Validation rmse = 1.231063
Epoch 21
Loss = 1.0426e-03, PNorm = 34.3928, GNorm = 0.9844, lr_0 = 1.9307e-04
Validation rmse = 1.249293
Epoch 22
Loss = 9.8196e-04, PNorm = 34.3982, GNorm = 1.0767, lr_0 = 1.7783e-04
Validation rmse = 1.184903
Epoch 23
Loss = 9.0633e-04, PNorm = 34.4034, GNorm = 0.5713, lr_0 = 1.6379e-04
Validation rmse = 1.194149
Epoch 24
Loss = 9.5592e-04, PNorm = 34.4081, GNorm = 1.2272, lr_0 = 1.5086e-04
Validation rmse = 1.197698
Epoch 25
Loss = 9.1834e-04, PNorm = 34.4121, GNorm = 1.3164, lr_0 = 1.3895e-04
Validation rmse = 1.181755
Epoch 26
Loss = 8.4725e-04, PNorm = 34.4166, GNorm = 0.7340, lr_0 = 1.2798e-04
Validation rmse = 1.183414
Epoch 27
Loss = 8.9496e-04, PNorm = 34.4208, GNorm = 0.6969, lr_0 = 1.1788e-04
Validation rmse = 1.164564
Epoch 28
Loss = 8.7151e-04, PNorm = 34.4243, GNorm = 1.2046, lr_0 = 1.0857e-04
Validation rmse = 1.178568
Epoch 29
Loss = 8.9034e-04, PNorm = 34.4280, GNorm = 2.2721, lr_0 = 1.0000e-04
Validation rmse = 1.158928
Model 0 best validation rmse = 1.158928 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.927209
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.9092e-02, PNorm = 33.9235, GNorm = 6.3707, lr_0 = 5.5000e-04
Validation rmse = 3.280612
Epoch 1
Loss = 1.4515e-02, PNorm = 33.9536, GNorm = 2.7077, lr_0 = 1.0000e-03
Validation rmse = 3.030617
Epoch 2
Loss = 1.3088e-02, PNorm = 34.0051, GNorm = 1.3044, lr_0 = 9.2106e-04
Validation rmse = 2.415131
Epoch 3
Loss = 9.0647e-03, PNorm = 34.0608, GNorm = 2.1204, lr_0 = 8.4834e-04
Validation rmse = 2.067639
Epoch 4
Loss = 6.8857e-03, PNorm = 34.1158, GNorm = 3.1100, lr_0 = 7.8137e-04
Validation rmse = 1.871460
Epoch 5
Loss = 5.0216e-03, PNorm = 34.1732, GNorm = 5.4497, lr_0 = 7.1969e-04
Validation rmse = 1.595871
Epoch 6
Loss = 3.6006e-03, PNorm = 34.2271, GNorm = 4.2891, lr_0 = 6.6287e-04
Validation rmse = 1.376448
Epoch 7
Loss = 2.9127e-03, PNorm = 34.2644, GNorm = 2.7131, lr_0 = 6.1054e-04
Validation rmse = 1.343012
Epoch 8
Loss = 2.0446e-03, PNorm = 34.2972, GNorm = 3.1779, lr_0 = 5.6234e-04
Validation rmse = 1.190819
Epoch 9
Loss = 1.6826e-03, PNorm = 34.3183, GNorm = 1.7003, lr_0 = 5.1795e-04
Validation rmse = 1.194189
Epoch 10
Loss = 1.7172e-03, PNorm = 34.3325, GNorm = 2.3066, lr_0 = 4.7706e-04
Validation rmse = 1.148488
Epoch 11
Loss = 1.4547e-03, PNorm = 34.3447, GNorm = 1.7134, lr_0 = 4.3940e-04
Validation rmse = 1.115675
Epoch 12
Loss = 1.3493e-03, PNorm = 34.3586, GNorm = 1.6816, lr_0 = 4.0471e-04
Validation rmse = 1.124314
Epoch 13
Loss = 1.3333e-03, PNorm = 34.3694, GNorm = 1.6891, lr_0 = 3.7276e-04
Validation rmse = 1.087732
Epoch 14
Loss = 1.2047e-03, PNorm = 34.3800, GNorm = 1.7323, lr_0 = 3.4333e-04
Validation rmse = 1.110211
Epoch 15
Loss = 1.2197e-03, PNorm = 34.3900, GNorm = 1.0872, lr_0 = 3.1623e-04
Validation rmse = 1.076538
Epoch 16
Loss = 1.0940e-03, PNorm = 34.3997, GNorm = 1.0223, lr_0 = 2.9126e-04
Validation rmse = 1.077111
Epoch 17
Loss = 1.0185e-03, PNorm = 34.4083, GNorm = 0.7703, lr_0 = 2.6827e-04
Validation rmse = 1.085152
Epoch 18
Loss = 1.0539e-03, PNorm = 34.4162, GNorm = 0.4326, lr_0 = 2.4709e-04
Validation rmse = 1.077483
Epoch 19
Loss = 1.0602e-03, PNorm = 34.4236, GNorm = 2.7214, lr_0 = 2.2758e-04
Validation rmse = 1.064628
Epoch 20
Loss = 1.0256e-03, PNorm = 34.4300, GNorm = 0.4699, lr_0 = 2.0962e-04
Validation rmse = 1.078911
Epoch 21
Loss = 9.4714e-04, PNorm = 34.4368, GNorm = 2.4977, lr_0 = 1.9307e-04
Validation rmse = 1.080707
Epoch 22
Loss = 9.4304e-04, PNorm = 34.4426, GNorm = 1.4000, lr_0 = 1.7783e-04
Validation rmse = 1.061652
Epoch 23
Loss = 8.7916e-04, PNorm = 34.4477, GNorm = 0.5318, lr_0 = 1.6379e-04
Validation rmse = 1.053428
Epoch 24
Loss = 8.9482e-04, PNorm = 34.4525, GNorm = 1.8600, lr_0 = 1.5086e-04
Validation rmse = 1.079561
Epoch 25
Loss = 8.8461e-04, PNorm = 34.4575, GNorm = 1.2031, lr_0 = 1.3895e-04
Validation rmse = 1.107047
Epoch 26
Loss = 8.8716e-04, PNorm = 34.4610, GNorm = 0.7269, lr_0 = 1.2798e-04
Validation rmse = 1.079085
Epoch 27
Loss = 7.9509e-04, PNorm = 34.4651, GNorm = 1.4004, lr_0 = 1.1788e-04
Validation rmse = 1.044211
Epoch 28
Loss = 7.9862e-04, PNorm = 34.4681, GNorm = 0.3872, lr_0 = 1.0857e-04
Validation rmse = 1.038697
Epoch 29
Loss = 7.8271e-04, PNorm = 34.4717, GNorm = 1.3753, lr_0 = 1.0000e-04
Validation rmse = 1.073879
Model 1 best validation rmse = 1.038697 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 1 test rmse = 0.943753
Ensemble test rmse = 0.927649
Fold 1
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'data/freesolv.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 2,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 2,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': False,
 'save_dir': 'examples/freesolv/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'task_names': ['freesolv'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 513,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 642 | train size = 513 | val size = 64 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.7761e-02, PNorm = 33.9476, GNorm = 6.6772, lr_0 = 5.5000e-04
Validation rmse = 3.891032
Epoch 1
Loss = 1.3150e-02, PNorm = 33.9804, GNorm = 8.1025, lr_0 = 1.0000e-03
Validation rmse = 3.281505
Epoch 2
Loss = 1.1492e-02, PNorm = 34.0259, GNorm = 6.1650, lr_0 = 9.2106e-04
Validation rmse = 3.330324
Epoch 3
Loss = 8.3199e-03, PNorm = 34.0775, GNorm = 0.7444, lr_0 = 8.4834e-04
Validation rmse = 2.527151
Epoch 4
Loss = 5.1678e-03, PNorm = 34.1321, GNorm = 5.7351, lr_0 = 7.8137e-04
Validation rmse = 2.253796
Epoch 5
Loss = 4.1673e-03, PNorm = 34.1818, GNorm = 3.5964, lr_0 = 7.1969e-04
Validation rmse = 1.733139
Epoch 6
Loss = 2.8634e-03, PNorm = 34.2238, GNorm = 2.7267, lr_0 = 6.6287e-04
Validation rmse = 1.636281
Epoch 7
Loss = 2.4762e-03, PNorm = 34.2568, GNorm = 1.4512, lr_0 = 6.1054e-04
Validation rmse = 1.484676
Epoch 8
Loss = 1.9559e-03, PNorm = 34.2782, GNorm = 1.7474, lr_0 = 5.6234e-04
Validation rmse = 1.483746
Epoch 9
Loss = 1.7397e-03, PNorm = 34.2995, GNorm = 4.2985, lr_0 = 5.1795e-04
Validation rmse = 1.326637
Epoch 10
Loss = 1.5627e-03, PNorm = 34.3120, GNorm = 1.1343, lr_0 = 4.7706e-04
Validation rmse = 1.420006
Epoch 11
Loss = 1.4121e-03, PNorm = 34.3276, GNorm = 1.1794, lr_0 = 4.3940e-04
Validation rmse = 1.277911
Epoch 12
Loss = 1.3362e-03, PNorm = 34.3419, GNorm = 0.7375, lr_0 = 4.0471e-04
Validation rmse = 1.226477
Epoch 13
Loss = 1.2107e-03, PNorm = 34.3525, GNorm = 0.6654, lr_0 = 3.7276e-04
Validation rmse = 1.221349
Epoch 14
Loss = 1.2527e-03, PNorm = 34.3637, GNorm = 1.4494, lr_0 = 3.4333e-04
Validation rmse = 1.257268
Epoch 15
Loss = 1.0852e-03, PNorm = 34.3733, GNorm = 0.8876, lr_0 = 3.1623e-04
Validation rmse = 1.242798
Epoch 16
Loss = 1.0754e-03, PNorm = 34.3831, GNorm = 2.5915, lr_0 = 2.9126e-04
Validation rmse = 1.211356
Epoch 17
Loss = 1.0740e-03, PNorm = 34.3906, GNorm = 2.7269, lr_0 = 2.6827e-04
Validation rmse = 1.236989
Epoch 18
Loss = 9.5951e-04, PNorm = 34.3986, GNorm = 0.8639, lr_0 = 2.4709e-04
Validation rmse = 1.173071
Epoch 19
Loss = 1.1812e-03, PNorm = 34.4059, GNorm = 3.2722, lr_0 = 2.2758e-04
Validation rmse = 1.180301
Epoch 20
Loss = 1.0591e-03, PNorm = 34.4123, GNorm = 1.7654, lr_0 = 2.0962e-04
Validation rmse = 1.247757
Epoch 21
Loss = 1.1950e-03, PNorm = 34.4181, GNorm = 1.0934, lr_0 = 1.9307e-04
Validation rmse = 1.304617
Epoch 22
Loss = 1.0572e-03, PNorm = 34.4246, GNorm = 1.5118, lr_0 = 1.7783e-04
Validation rmse = 1.305905
Epoch 23
Loss = 9.1988e-04, PNorm = 34.4303, GNorm = 2.1564, lr_0 = 1.6379e-04
Validation rmse = 1.178706
Epoch 24
Loss = 8.5338e-04, PNorm = 34.4352, GNorm = 1.1978, lr_0 = 1.5086e-04
Validation rmse = 1.198048
Epoch 25
Loss = 8.5621e-04, PNorm = 34.4399, GNorm = 0.7625, lr_0 = 1.3895e-04
Validation rmse = 1.159914
Epoch 26
Loss = 8.1591e-04, PNorm = 34.4435, GNorm = 2.6453, lr_0 = 1.2798e-04
Validation rmse = 1.199199
Epoch 27
Loss = 7.7999e-04, PNorm = 34.4470, GNorm = 1.3548, lr_0 = 1.1788e-04
Validation rmse = 1.276319
Epoch 28
Loss = 8.7375e-04, PNorm = 34.4505, GNorm = 0.4357, lr_0 = 1.0857e-04
Validation rmse = 1.232696
Epoch 29
Loss = 8.1803e-04, PNorm = 34.4529, GNorm = 0.8801, lr_0 = 1.0000e-04
Validation rmse = 1.167112
Model 0 best validation rmse = 1.159914 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.917146
Building model 1
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.7590e-02, PNorm = 33.9538, GNorm = 6.5007, lr_0 = 5.5000e-04
Validation rmse = 4.213989
Epoch 1
Loss = 1.3652e-02, PNorm = 33.9855, GNorm = 8.1659, lr_0 = 1.0000e-03
Validation rmse = 3.530418
Epoch 2
Loss = 1.1497e-02, PNorm = 34.0312, GNorm = 9.9033, lr_0 = 9.2106e-04
Validation rmse = 3.161601
Epoch 3
Loss = 8.2634e-03, PNorm = 34.0866, GNorm = 2.0653, lr_0 = 8.4834e-04
Validation rmse = 2.875864
Epoch 4
Loss = 5.6270e-03, PNorm = 34.1414, GNorm = 2.8470, lr_0 = 7.8137e-04
Validation rmse = 2.185893
Epoch 5
Loss = 3.7806e-03, PNorm = 34.1862, GNorm = 4.2789, lr_0 = 7.1969e-04
Validation rmse = 1.733520
Epoch 6
Loss = 3.4554e-03, PNorm = 34.2262, GNorm = 1.5653, lr_0 = 6.6287e-04
Validation rmse = 2.082757
Epoch 7
Loss = 3.6258e-03, PNorm = 34.2549, GNorm = 9.3794, lr_0 = 6.1054e-04
Validation rmse = 1.711407
Epoch 8
Loss = 3.3351e-03, PNorm = 34.2825, GNorm = 1.4341, lr_0 = 5.6234e-04
Validation rmse = 1.604688
Epoch 9
Loss = 2.6611e-03, PNorm = 34.3066, GNorm = 1.9110, lr_0 = 5.1795e-04
Validation rmse = 1.479574
Epoch 10
Loss = 2.0414e-03, PNorm = 34.3266, GNorm = 1.9805, lr_0 = 4.7706e-04
Validation rmse = 1.377088
Epoch 11
Loss = 1.6501e-03, PNorm = 34.3421, GNorm = 0.9371, lr_0 = 4.3940e-04
Validation rmse = 1.245472
Epoch 12
Loss = 1.3586e-03, PNorm = 34.3545, GNorm = 1.4024, lr_0 = 4.0471e-04
Validation rmse = 1.278518
Epoch 13
Loss = 1.3353e-03, PNorm = 34.3647, GNorm = 1.2743, lr_0 = 3.7276e-04
Validation rmse = 1.249807
Epoch 14
Loss = 1.2506e-03, PNorm = 34.3743, GNorm = 1.1460, lr_0 = 3.4333e-04
Validation rmse = 1.287988
Epoch 15
Loss = 1.2133e-03, PNorm = 34.3831, GNorm = 0.7611, lr_0 = 3.1623e-04
Validation rmse = 1.281406
Epoch 16
Loss = 1.3862e-03, PNorm = 34.3919, GNorm = 2.4321, lr_0 = 2.9126e-04
Validation rmse = 1.312745
Epoch 17
Loss = 1.1981e-03, PNorm = 34.3991, GNorm = 1.9483, lr_0 = 2.6827e-04
Validation rmse = 1.270976
Epoch 18
Loss = 1.0745e-03, PNorm = 34.4077, GNorm = 0.5338, lr_0 = 2.4709e-04
Validation rmse = 1.203731
Epoch 19
Loss = 1.0451e-03, PNorm = 34.4143, GNorm = 0.4787, lr_0 = 2.2758e-04
Validation rmse = 1.220251
Epoch 20
Loss = 1.0888e-03, PNorm = 34.4209, GNorm = 0.4326, lr_0 = 2.0962e-04
Validation rmse = 1.219240
Epoch 21
Loss = 9.6353e-04, PNorm = 34.4278, GNorm = 0.4068, lr_0 = 1.9307e-04
Validation rmse = 1.175926
Epoch 22
Loss = 9.3443e-04, PNorm = 34.4340, GNorm = 1.6734, lr_0 = 1.7783e-04
Validation rmse = 1.211329
Epoch 23
Loss = 1.0184e-03, PNorm = 34.4395, GNorm = 1.4128, lr_0 = 1.6379e-04
Validation rmse = 1.123552
Epoch 24
Loss = 9.3806e-04, PNorm = 34.4449, GNorm = 1.2880, lr_0 = 1.5086e-04
Validation rmse = 1.103536
Epoch 25
Loss = 8.8163e-04, PNorm = 34.4493, GNorm = 0.8560, lr_0 = 1.3895e-04
Validation rmse = 1.106761
Epoch 26
Loss = 9.1429e-04, PNorm = 34.4537, GNorm = 0.5299, lr_0 = 1.2798e-04
Validation rmse = 1.113287
Epoch 27
Loss = 8.5099e-04, PNorm = 34.4579, GNorm = 0.9438, lr_0 = 1.1788e-04
Validation rmse = 1.115842
Epoch 28
Loss = 8.6559e-04, PNorm = 34.4625, GNorm = 0.7485, lr_0 = 1.0857e-04
Validation rmse = 1.084566
Epoch 29
Loss = 8.3421e-04, PNorm = 34.4659, GNorm = 0.4437, lr_0 = 1.0000e-04
Validation rmse = 1.073345
Model 1 best validation rmse = 1.073345 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 1 test rmse = 0.890137
Ensemble test rmse = 0.887609
2-fold cross validation
Seed 0 ==> test rmse = 0.927649
Seed 1 ==> test rmse = 0.887609
Overall test rmse = 0.907629 +/- 0.020020
